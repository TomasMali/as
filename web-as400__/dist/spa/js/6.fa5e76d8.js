"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[6],{5006:(e,l,a)=>{a.r(l),a.d(l,{default:()=>D});var t=a(3673),i=a(8880);const o={class:""},s={class:"row q-mb-md"},r={key:0,class:"col q-mr-md",style:{"border-style":"ridge"}},n={class:"col flex q-pa-md",style:{"border-style":"ridge"}},d={class:"row q-pa-md",style:{"border-style":"ridge"}},c={class:"q-ml-lg scritta"};function m(e,l,a,m,h,u){const g=(0,t.up)("q-option-group"),f=(0,t.up)("q-icon"),p=(0,t.up)("q-input"),b=(0,t.up)("q-btn"),E=(0,t.up)("q-checkbox"),y=(0,t.up)("q-item-section"),A=(0,t.up)("q-item"),w=(0,t.up)("q-select"),T=(0,t.up)("q-toggle"),L=(0,t.up)("q-card-section"),N=(0,t.up)("q-card"),S=(0,t.up)("q-inner-loading"),C=(0,t.up)("q-table");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t.Wm)(N,{bordered:"",class:"q-my-sm q-mx-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(L,{class:""},{default:(0,t.w5)((()=>[(0,t._)("div",s,[h.pref.getUserPrefAsObj.length>0?((0,t.wg)(),(0,t.iD)("div",r,[(0,t.Wm)(g,{class:"q-mt-md",modelValue:h.group,"onUpdate:modelValue":[l[0]||(l[0]=e=>h.group=e),u.onGroupChange],options:h.pref.getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","onUpdate:modelValue","options"])])):(0,t.kq)("",!0),(0,t._)("div",n,[(0,t.Wm)(p,{dense:"",style:{width:"170px"},square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:h.fastWordSearch,"onUpdate:modelValue":l[1]||(l[1]=e=>h.fastWordSearch=e),label:"Fast Search",onKeyup:(0,i.D2)(u.fastSearch,["enter"])},{append:(0,t.w5)((()=>[(0,t.Wm)(f,{name:"bolt",color:"primary"})])),_:1},8,["modelValue","onKeyup"]),(0,t.Wm)(b,{dense:"",loading:h.loading,inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:u.fastSearch,disable:null==h.fastWordSearch||""==h.fastWordSearch||h.fastWordSearch.length<3},null,8,["loading","onClick","disable"]),(0,t.Wm)(E,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:h.searchFile,"onUpdate:modelValue":l[2]||(l[2]=e=>h.searchFile=e),label:"Cerca File"},null,8,["modelValue"]),(0,t.Wm)(E,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:h.deep,"onUpdate:modelValue":l[3]||(l[3]=e=>h.deep=e),label:"Ricerca profonda"},null,8,["modelValue"])])]),(0,t._)("div",d,[(0,t.Wm)(w,{dense:"",filled:"",modelValue:h.libDatModel,"onUpdate:modelValue":[l[4]||(l[4]=e=>h.libDatModel=e),u.onClickLibdat],"use-input":"","input-debounce":"0",label:"LIBDAT",clearable:"",options:h.options,onFilter:u.filterFn,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(y,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue"]),(0,t.Wm)(w,{class:"q-ml-md",style:{"max-height":"500px"},dense:"",filled:"",modelValue:h.fileNameModel,"onUpdate:modelValue":[l[5]||(l[5]=e=>h.fileNameModel=e),u.onClickFilename],"use-input":"",loading:h.loadingInputFiles,disable:h.loadingInputFiles,"input-debounce":"0",label:"FILE",autofocus:"",clearable:"",options:h.fileNamesOptions,onFilter:u.filterFileNames,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(y,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","loading","disable","options","onFilter","onUpdate:modelValue"]),(0,t._)("div",c,[(0,t.Wm)(T,{dense:"",modelValue:h.queryToggle,"onUpdate:modelValue":l[6]||(l[6]=e=>h.queryToggle=e),size:"xl",icon:"visibility",label:"Show 500",color:"red"},null,8,["modelValue"])])])])),_:1})])),_:1}),h.queryToggle||h.queryStr.launchQueryPrefered?h.queryToggle&&!h.queryStr.launchQueryPrefered?((0,t.wg)(),(0,t.j4)(C,{key:1,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white ",rows:h.queries,"row-key":"index",dense:"","auto-width":"",grid:h.grid,loading:h.loading,boarderd:"",title:h.fileNameModel,separator:"cell",style:{height:"640px"},filter:h.filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18],ref:"tabCol"},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(p,{borderless:"",dense:"",debounce:"300",modelValue:h.filter,"onUpdate:modelValue":l[10]||(l[10]=e=>h.filter=e),placeholder:"Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(f,{name:"search",color:"white"}),(0,t.Wm)(T,{modelValue:h.grid,"onUpdate:modelValue":l[9]||(l[9]=e=>h.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(b,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:u.exportTableField},null,8,["onClick"])])),_:1},8,["rows","grid","loading","title","filter"])):h.queryStr.queries.length?((0,t.wg)(),(0,t.j4)(C,{key:2,loading:h.queryStr.loadingTable,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:h.queryStr.queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:h.queryStr.filter,grid:h.queryStr.grid,ref:"queryTab"},{loading:(0,t.w5)((()=>[(0,t.Wm)(S,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(p,{borderless:"",dense:"",debounce:"300",modelValue:h.queryStr.filter,"onUpdate:modelValue":l[12]||(l[12]=e=>h.queryStr.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(f,{name:"search",color:"white"}),(0,t.Wm)(T,{color:"red",modelValue:h.queryStr.grid,"onUpdate:modelValue":l[11]||(l[11]=e=>h.queryStr.grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(b,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:u.exportTableQuery},null,8,["onClick"])])),_:1},8,["loading","rows","filter","grid"])):(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(C,{key:0,loading:h.loadingTable,dense:"","auto-width":"",class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",grid:h.grid,rows:h.rows,columns:h.columns,"row-key":"name",boarderd:"",title:h.fileNameModel,separator:"cell",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:h.filter,ref:"tb"},{loading:(0,t.w5)((()=>[(0,t.Wm)(S,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(f,{name:"search",size:"sm",class:"q-mr-sm",color:"white"}),(0,t.Wm)(p,{class:"",borderless:"",dense:"",modelValue:h.filter,"onUpdate:modelValue":l[8]||(l[8]=e=>h.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(T,{modelValue:h.grid,"onUpdate:modelValue":l[7]||(l[7]=e=>h.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(b,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:u.exportTable},null,8,["onClick"])])),_:1},8,["loading","grid","rows","columns","title","filter"])),(u.libDatModelComputed,(0,t.kq)("",!0))])}a(5663),a(3610);var h=a(1959),u=a(2841),g=a(8825),f=a(6041),p=a(1390),b=a(5214),E=a(9889),y=a(1965);const A={data(){return{q:(0,g.Z)(),as:null,pref:null,queryStr:null,voice:null,fastWordSearch:"",deep:!1,searchFile:!1,queries:[],queryToggle:!1,launchQueryPrefered:!1,pagination:{rowsPerPage:0},group:(0,h.iH)(""),loadingInputFiles:!1,libDatModel:null,stringOptions:[],options:this.stringOptions,fileNameModel:null,filenamesArray:[],fileNamesOptions:this.filenamesArray,separator:"vertical",filter:"",grid:!1,loading:!1,loadingTable:!1,fileName:"ROLE_USER",lib:"WRKJEXP",rows:[],columns:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}],selectedFileName:{},blockLocalStorage:!1}},computed:{libDatModelComputed(){return null==this.queryStr.getSelectedFileName||this.blockLocalStorage?(this.blockLocalStorage=!1,"original"):this.onClickFilenameForced()}},methods:{voiceChanged(){},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.columns.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,u.Z)("table-export.csv",e,"text/csv")},exportTableField(){var e=[];this.$refs.tabCol.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(this.$refs.tabCol.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const a=[l.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tabCol.filteredSortedRows.map((e=>l.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,u.Z)("table-export.csv",a,"text/csv")},exportTableQuery(){var e=[];this.$refs.queryTab.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(this.$refs.queryTab.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const a=[l.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.queryTab.filteredSortedRows.map((e=>l.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,u.Z)("table-export.csv",a,"text/csv")},wrapCsvValue(e,l){let a=void 0!==l?l(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`},async loadFilenames(){try{const e={filename:this.libDatModel};this.loadingInputFiles=!0,await this.as.getFilenamesAction(e),this.filenamesArray=[],this.as.getFilenames.forEach((e=>{this.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),this.loadingInputFiles=!1}catch(e){console.log(e)}},async loadLibdat(){try{const e={user:""};await this.pref.setUserPref(this.q.localStorage.getItem("currentUser")),await this.pref.getUserPrefAsObj.length>0&&(this.group=this.pref.getUserPrefAsObj[0].value,this.libDatModel=this.group),await this.as.getUsersAction(e),await this.as.getUsers.forEach((e=>{this.stringOptions.push(e.TABLE_SCHEMA)})),this.loadFilenames()}catch(e){console.log(e)}},async loadFiles(){if(null!=this.fileNameModel){this.loadingTable=!0,this.rows=[];try{var e={lib:this.libDatModel,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(l){console.log(l),this.loadingTable=!1}}},async loadFilesForced(){this.loadingTable=!0,this.rows=[];try{const e={lib:this.queryStr.getSelectedFileName.libname,fileName:this.queryStr.getSelectedFileName.filename};this.libDatModel=this.queryStr.getSelectedFileName.libname,this.fileNameModel=this.queryStr.getSelectedFileName.filenameOriginal,this.loadFilenames(),await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(e){console.log(e),this.loadingTable=!1}},async loadQueries(){if(this.fileNameModel){this.loading=!0,this.queries=[];try{const e={lib:this.libDatModel,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getQueriesAction(e),this.queries=this.as.getQueries,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},async loadFastFiles(){if(this.fastWordSearch.length>=3){this.loading=!0,this.rows=[];try{const e={user:null!=this.q.localStorage.getItem("currentUser")&&""!=this.q.localStorage.getItem("currentUser")?this.q.localStorage.getItem("currentUser").trim():"",search_word:this.fastWordSearch.trim(),all:this.deep?"all":"no",searchFile:this.searchFile?"true":"false"};await this.as.getFastFilesAction(e),this.rows=this.as.getFastFiles,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},onClickLibdat(e){this.loadFilenames(),this.fileNameModel=null},onClickFilename(e){this.loadFiles(),this.updateLocalStorageForFastResearch(),this.filter="",this.queryStr.launchQueryPrefered=!1},onClickFilenameForced(e){return this.loadFilesForced(),this.filter="",this.queryStr.launchQueryPrefered=!1,"local"},filterFileNames(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.fileNamesOptions=this.filenamesArray.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.fileNamesOptions=this.filenamesArray})},filterFn(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.options=this.stringOptions.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.options=this.stringOptions})},fastSearch(){this.loadFastFiles()},onGroupChange(){this.blockLocalStorage=!0,this.libDatModel=this.group,this.loadFilenames(),this.fileNameModel=null},updateLocalStorageForFastResearch(){if(null!=this.libDatModel&&null!=this.fileNameModel){var e=this.libDatModel.trim()+"."+this.fileNameModel.trim(),l=[];null==this.q.localStorage.getItem("fileNameList")?(l.push(e),this.q.localStorage.set("fileNameList",l)):(l=this.q.localStorage.getItem("fileNameList"),l.includes(e)||(l.length>9?(l.shift(),l.push(e),this.q.localStorage.set("fileNameList",l)):(l.push(e),this.q.localStorage.set("fileNameList",l)))),this.queryStr.setFileNameListLocalStorage()}}},watch:{queryToggle(e,l){e&&(this.loadQueries(),this.queryStr.launchQueryPrefered=!1)},fileNameModel(e,l){""!==e&&null!=this.fileNameModel&&this.queryToggle&&this.loadQueries()},fastWordSearch(e,l){},searchFile(e,l){this.columns=e?[{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"TABLE_TEXT",label:"TABLE_TEXT",field:"TABLE_TEXT",sortable:!0,align:"center"},{name:"TABLE_DEFINER",label:"TABLE_DEFINER",field:"TABLE_DEFINER",sortable:!0,align:"center"}]:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}]}},created(){this.as=(0,p.o)(),this.pref=(0,b.H)(),this.queryStr=(0,f.U)(),this.loadLibdat(),this.voice=(0,E._)(),this.selectedFileName=this.queryStr.getSelectedFileName},components:{Voice:y.Z}};var w=a(4260),T=a(151),L=a(5589),N=a(8758),S=a(4842),C=a(4554),M=a(8240),q=a(5735),_=a(3017),F=a(3414),U=a(2035),V=a(8886),I=a(8107),O=a(6941),R=a(7518),v=a.n(R);const x=(0,w.Z)(A,[["render",m]]),D=x;v()(A,"components",{QCard:T.Z,QCardSection:L.Z,QOptionGroup:N.Z,QInput:S.Z,QIcon:C.Z,QBtn:M.Z,QCheckbox:q.Z,QSelect:_.Z,QItem:F.Z,QItemSection:U.Z,QToggle:V.Z,QTable:I.Z,QInnerLoading:O.Z})}}]);