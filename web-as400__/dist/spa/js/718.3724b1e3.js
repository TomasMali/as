"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[718],{9718:(e,l,a)=>{a.r(l),a.d(l,{default:()=>k});var t=a(3673),i=a(8880);const o={class:"q-pa-xs"},s={class:"row q-mb-md"},r={key:0,class:"col q-mr-md",style:{"border-style":"ridge"}},n={class:"col flex q-pa-md",style:{"border-style":"ridge"}},d={class:"row q-pa-md",style:{"border-style":"ridge"}},c={class:"q-ml-lg scritta"},h={class:"q-pa-md"};function m(e,l,a,m,u,g){const f=(0,t.up)("q-option-group"),p=(0,t.up)("q-icon"),b=(0,t.up)("q-input"),E=(0,t.up)("q-btn"),y=(0,t.up)("q-checkbox"),A=(0,t.up)("q-item-section"),w=(0,t.up)("q-item"),T=(0,t.up)("q-select"),L=(0,t.up)("q-toggle"),N=(0,t.up)("q-card-section"),S=(0,t.up)("q-inner-loading"),C=(0,t.up)("q-table");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t.Wm)(N,{class:"shadow-10"},{default:(0,t.w5)((()=>[(0,t._)("div",s,[u.pref.getUserPrefAsObj.length>0?((0,t.wg)(),(0,t.iD)("div",r,[(0,t.Wm)(f,{class:"q-mt-md",modelValue:u.group,"onUpdate:modelValue":[l[0]||(l[0]=e=>u.group=e),g.onGroupChange],options:u.pref.getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","onUpdate:modelValue","options"])])):(0,t.kq)("",!0),(0,t._)("div",n,[(0,t.Wm)(b,{dense:"",style:{width:"250px"},square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:u.fastWordSearch,"onUpdate:modelValue":l[1]||(l[1]=e=>u.fastWordSearch=e),label:"Fast Search",onKeyup:(0,i.D2)(g.fastSearch,["enter"])},{append:(0,t.w5)((()=>[(0,t.Wm)(p,{name:"bolt",color:"primary"})])),_:1},8,["modelValue","onKeyup"]),(0,t.Wm)(E,{dense:"",loading:u.loading,inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:g.fastSearch,disable:null==u.fastWordSearch||""==u.fastWordSearch||u.fastWordSearch.length<3},null,8,["loading","onClick","disable"]),(0,t.Wm)(y,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:u.searchFile,"onUpdate:modelValue":l[2]||(l[2]=e=>u.searchFile=e),label:"Cerca File"},null,8,["modelValue"]),(0,t.Wm)(y,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:u.deep,"onUpdate:modelValue":l[3]||(l[3]=e=>u.deep=e),label:"Ricerca profonda"},null,8,["modelValue"])])]),(0,t._)("div",d,[(0,t.Wm)(T,{dense:"",filled:"",modelValue:u.libDatModel,"onUpdate:modelValue":[l[4]||(l[4]=e=>u.libDatModel=e),g.onClickLibdat],"use-input":"","input-debounce":"0",label:"LIBDAT",clearable:"",options:u.options,onFilter:g.filterFn,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(A,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue"]),(0,t.Wm)(T,{class:"q-ml-md",style:{"max-height":"500px"},dense:"",filled:"",modelValue:u.fileNameModel,"onUpdate:modelValue":[l[5]||(l[5]=e=>u.fileNameModel=e),g.onClickFilename],"use-input":"",loading:u.loadingInputFiles,disable:u.loadingInputFiles,"input-debounce":"0",label:"FILE",autofocus:"",clearable:"",options:u.fileNamesOptions,onFilter:g.filterFileNames,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(A,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","loading","disable","options","onFilter","onUpdate:modelValue"]),(0,t._)("div",c,[(0,t.Wm)(L,{dense:"",modelValue:u.queryToggle,"onUpdate:modelValue":l[6]||(l[6]=e=>u.queryToggle=e),size:"xl",icon:"visibility",label:"Show 500",color:"red"},null,8,["modelValue"])])])])),_:1}),(0,t._)("div",h,[u.queryToggle||u.queryStr.launchQueryPrefered?u.queryToggle&&!u.queryStr.launchQueryPrefered?((0,t.wg)(),(0,t.j4)(C,{key:1,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white ",rows:u.queries,"row-key":"index",dense:"","auto-width":"",grid:u.grid,loading:u.loading,boarderd:"",title:u.fileNameModel,separator:"cell",style:{height:"640px"},filter:u.filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18],ref:"tabCol"},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(b,{borderless:"",dense:"",debounce:"300",clearable:"",modelValue:u.filter,"onUpdate:modelValue":l[10]||(l[10]=e=>u.filter=e),placeholder:"Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(p,{name:"search",color:"white"}),(0,t.Wm)(L,{modelValue:u.grid,"onUpdate:modelValue":l[9]||(l[9]=e=>u.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(E,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:g.exportTableField},null,8,["onClick"])])),_:1},8,["rows","grid","loading","title","filter"])):u.queryStr.queries.length?((0,t.wg)(),(0,t.j4)(C,{key:2,loading:u.queryStr.loadingTable,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:u.queryStr.queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:u.queryStr.filter,grid:u.queryStr.grid,ref:"queryTab"},{loading:(0,t.w5)((()=>[(0,t.Wm)(S,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(b,{borderless:"",dense:"",debounce:"300",clearable:"",modelValue:u.queryStr.filter,"onUpdate:modelValue":l[12]||(l[12]=e=>u.queryStr.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(p,{name:"search",color:"white"}),(0,t.Wm)(L,{color:"red",modelValue:u.queryStr.grid,"onUpdate:modelValue":l[11]||(l[11]=e=>u.queryStr.grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(E,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:g.exportTableQuery},null,8,["onClick"])])),_:1},8,["loading","rows","filter","grid"])):(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(C,{key:0,loading:u.loadingTable,dense:"","auto-width":"",class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",grid:u.grid,rows:u.rows,columns:u.columns,"row-key":"name",boarderd:"",title:u.fileNameModel,separator:"cell",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:u.filter,ref:"tb"},{loading:(0,t.w5)((()=>[(0,t.Wm)(S,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(p,{name:"search",size:"sm",class:"q-mr-sm",color:"white"}),(0,t.Wm)(b,{class:"",borderless:"",clearable:"",dense:"",modelValue:u.filter,"onUpdate:modelValue":l[8]||(l[8]=e=>u.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(L,{modelValue:u.grid,"onUpdate:modelValue":l[7]||(l[7]=e=>u.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(E,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:g.exportTable},null,8,["onClick"])])),_:1},8,["loading","grid","rows","columns","title","filter"]))]),(g.libDatModelComputed,(0,t.kq)("",!0))])}a(5663),a(3610);var u=a(1959),g=a(2841),f=a(8825),p=a(6041),b=a(1390),E=a(5214),y=a(9889),A=a(1965);const w={data(){return{q:(0,f.Z)(),as:null,pref:null,queryStr:null,voice:null,fastWordSearch:"",deep:!1,searchFile:!1,queries:[],queryToggle:!1,launchQueryPrefered:!1,pagination:{rowsPerPage:0},group:(0,u.iH)(""),loadingInputFiles:!1,libDatModel:null,stringOptions:[],options:this.stringOptions,fileNameModel:null,filenamesArray:[],fileNamesOptions:this.filenamesArray,separator:"vertical",filter:"",grid:!1,loading:!1,loadingTable:!1,fileName:"ROLE_USER",lib:"WRKJEXP",rows:[],columns:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}],selectedFileName:{},blockLocalStorage:!1}},computed:{libDatModelComputed(){return null==this.queryStr.getSelectedFileName||this.blockLocalStorage?(this.blockLocalStorage=!1,"original"):this.onClickFilenameForced()}},methods:{voiceChanged(){},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.columns.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,g.Z)("table-export.csv",e,"text/csv")},exportTableField(){var e=[];this.$refs.tabCol.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(this.$refs.tabCol.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const a=[l.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tabCol.filteredSortedRows.map((e=>l.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,g.Z)("table-export.csv",a,"text/csv")},exportTableQuery(){var e=[];this.$refs.queryTab.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(this.$refs.queryTab.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const a=[l.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.queryTab.filteredSortedRows.map((e=>l.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,g.Z)("table-export.csv",a,"text/csv")},wrapCsvValue(e,l){let a=void 0!==l?l(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`},async loadFilenames(){try{const e={filename:this.libDatModel};this.loadingInputFiles=!0,await this.as.getFilenamesAction(e),this.filenamesArray=[],this.as.getFilenames.forEach((e=>{this.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),this.loadingInputFiles=!1}catch(e){console.log(e)}},async loadLibdat(){try{const e={user:""};await this.pref.setUserPref(this.q.localStorage.getItem("currentUser")),await this.pref.getUserPrefAsObj.length>0&&(this.group=this.pref.getUserPrefAsObj[0].value,this.libDatModel=this.group),await this.as.getUsersAction(e),await this.as.getUsers.forEach((e=>{this.stringOptions.push(e.TABLE_SCHEMA)})),this.loadFilenames()}catch(e){console.log(e)}},async loadFiles(){if(null!=this.fileNameModel){this.loadingTable=!0,this.rows=[];try{var e={lib:this.libDatModel,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(l){console.log(l),this.loadingTable=!1}}},async loadFilesForced(){this.loadingTable=!0,this.rows=[];try{const e={lib:this.queryStr.getSelectedFileName.libname,fileName:this.queryStr.getSelectedFileName.filename};this.libDatModel=this.queryStr.getSelectedFileName.libname,this.fileNameModel=this.queryStr.getSelectedFileName.filenameOriginal,this.loadFilenames(),await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(e){console.log(e),this.loadingTable=!1}},async loadQueries(){if(this.fileNameModel){this.loading=!0,this.queries=[];try{const e={lib:this.libDatModel,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getQueriesAction(e),this.queries=this.as.getQueries,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},async loadFastFiles(){if(this.fastWordSearch.length>=3){this.loading=!0,this.rows=[];try{const e={user:null!=this.q.localStorage.getItem("currentUser")&&""!=this.q.localStorage.getItem("currentUser")?this.q.localStorage.getItem("currentUser").trim():"",search_word:this.fastWordSearch.trim(),all:this.deep?"all":"no",searchFile:this.searchFile?"true":"false"};await this.as.getFastFilesAction(e),this.rows=this.as.getFastFiles,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},onClickLibdat(e){this.loadFilenames(),this.fileNameModel=null},onClickFilename(e){this.loadFiles(),this.updateLocalStorageForFastResearch(),this.filter="",this.queryStr.launchQueryPrefered=!1},onClickFilenameForced(e){return this.loadFilesForced(),this.filter="",this.queryStr.launchQueryPrefered=!1,"local"},filterFileNames(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.fileNamesOptions=this.filenamesArray.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.fileNamesOptions=this.filenamesArray})},filterFn(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.options=this.stringOptions.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.options=this.stringOptions})},fastSearch(){this.loadFastFiles()},onGroupChange(){this.blockLocalStorage=!0,this.libDatModel=this.group,this.loadFilenames(),this.fileNameModel=null},updateLocalStorageForFastResearch(){if(null!=this.libDatModel&&null!=this.fileNameModel){var e=this.libDatModel.trim()+"."+this.fileNameModel.trim(),l=[];null==this.q.localStorage.getItem("fileNameList")?(l.push(e),this.q.localStorage.set("fileNameList",l)):(l=this.q.localStorage.getItem("fileNameList"),l.includes(e)||(l.length>9?(l.shift(),l.push(e),this.q.localStorage.set("fileNameList",l)):(l.push(e),this.q.localStorage.set("fileNameList",l)))),this.queryStr.setFileNameListLocalStorage()}}},watch:{queryToggle(e,l){e&&(this.loadQueries(),this.queryStr.launchQueryPrefered=!1)},fileNameModel(e,l){""!==e&&null!=this.fileNameModel&&this.queryToggle&&this.loadQueries()},fastWordSearch(e,l){},searchFile(e,l){this.columns=e?[{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"TABLE_TEXT",label:"TABLE_TEXT",field:"TABLE_TEXT",sortable:!0,align:"center"},{name:"TABLE_DEFINER",label:"TABLE_DEFINER",field:"TABLE_DEFINER",sortable:!0,align:"center"}]:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}]}},created(){this.as=(0,b.o)(),this.pref=(0,E.H)(),this.queryStr=(0,p.U)(),this.loadLibdat(),this.voice=(0,y._)(),this.selectedFileName=this.queryStr.getSelectedFileName},components:{Voice:A.Z}};var T=a(4260),L=a(151),N=a(5589),S=a(8758),C=a(4842),M=a(4554),q=a(8240),_=a(5735),F=a(3017),U=a(3414),V=a(2035),I=a(8886),O=a(8107),R=a(6941),v=a(7518),x=a.n(v);const D=(0,T.Z)(w,[["render",m]]),k=D;x()(w,"components",{QCard:L.Z,QCardSection:N.Z,QOptionGroup:S.Z,QInput:C.Z,QIcon:M.Z,QBtn:q.Z,QCheckbox:_.Z,QSelect:F.Z,QItem:U.Z,QItemSection:V.Z,QToggle:I.Z,QTable:O.Z,QInnerLoading:R.Z})}}]);