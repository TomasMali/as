"use strict";(self["webpackChunkweb_as400"]=self["webpackChunkweb_as400"]||[]).push([[174],{7174:(e,l,t)=>{t.r(l),t.d(l,{default:()=>ae});var a=t(3673),o=t(1959),i=t(2323),r=t(8880),s=t(8825),n=t(6041),d=t(5214);const u={class:"q-px-xl"},c=(0,a.Uk)(" Crea "),m={key:0,class:"flex flex-center"},p=(0,a.Uk)("Caricando le query...."),w={key:0,class:"flex flex-center text-red"},g=(0,a.Uk)("   "),f=(0,a.Uk)("\n   "),y=(0,a._)("div",{class:"text-h6 text-primary"},"Composizione query",-1),b={style:{"max-height":"80vh"},class:"my-modify-placeholder scroll"},U={class:"row q-col-gutter-x-md"},S={class:"col"},h={class:"col"},_={class:"col"},q={class:"row"},x={class:"q-pa-md row items-start q-gutter-md"},W={class:"text-subtitle2 text-red q-mt-lg"},Q=(0,a.Uk)("No results"),k=(0,a.Uk)("No results"),v={class:"vertical"},C={class:"text-subtitle2 text-red q-ma-none"},L={class:""},V={setup(e){const l=(0,n.U)(),t=(0,s.Z)(),V=(0,d.H)(),T=(0,o.iH)(""),Z=e=>{console.log(e),l.setPreview()},A=async e=>{l.loadingTable=!0,await l.excecQuery(e),l.loadingTable=!1},M=async()=>{l.loaderUserQuery=!0,await l.selectUserQuery(t.localStorage.getItem("currentUser")),l.loaderUserQuery=!1,T.value=V.getUserPrefAsObj[0].value,l.libdatM=T.value,O()},E=()=>{l.libdatM=T.value,O(),l.fileM=(0,o.iH)(null),l.selected=(0,o.iH)([]),l.rows=[]},D=e=>{l.sqlAutomati(),l.toggleWhere&&H()},H=async()=>{if(l.fileM&&l.libdatM){l.columsLoading=!0,l.rows=[];try{const e={lib:l.libdatM,fileName:l.fileM.split("--\x3e")[0].trim()};console.log("Dove sono"),console.log(e),await l.getColumsAction(e),l.columsLoading=!1}catch(e){console.log(e),l.columsLoading=!1}}},I=()=>{l.sqlAutomati(),D({}),l.selected=(0,o.iH)([])},F=(e,a)=>{t.dialog({dark:!0,title:"Confirm",message:"Vuoi cancellare la tua query?",cancel:!0,persistent:!0}).onOk((()=>{t.notify({color:"primary",textColor:"white",icon:"delete",message:"Query cancellata con successo",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),l.deleteUserQuery(e,a)})).onCancel((()=>{})).onDismiss((()=>{}))},O=()=>{z(),l.sqlAutomati()},z=async()=>{try{const e={filename:l.libdatM};l.loadingFileM=!0,await l.getFilenamesAction(e),l.filenamesArray=[],l.getFilenames.forEach((e=>{l.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),l.loadingFileM=!1}catch(e){console.log(e)}},N=async()=>{await l.insertUserQuery({user:t.localStorage.getItem("currentUser"),title:l.title,sqlstr:l.sqlQuery,note:l.note}),t.notify({color:"primary",textColor:"white",icon:"insert",message:"Query inserita con successo",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),l.user=(0,o.iH)(""),l.title=(0,o.iH)(""),l.sqlQuery=(0,o.iH)(""),l.note=(0,o.iH)("")},P=e=>{l.user=e.LIBDAT,l.title=e.TITLE,l.sqlQuery=e.SQLSTR,l.note=e.NOTE,l.dialog=!0,l.createDialog=!1},j=(e,t)=>{t(""!==e?()=>{const t=e.toLowerCase();l.optionLibdat=l.stringOptLibdat.filter((e=>e.toLowerCase().indexOf(t)>-1))}:()=>{l.optionLibdat=l.stringOptLibdat})},B=(e,t)=>{t(""!==e?()=>{const t=e.toLowerCase();l.optionFile=l.filenamesArray.filter((e=>e.toLowerCase().indexOf(t)>-1))}:()=>{l.optionFile=l.filenamesArray})},R=async()=>{l.sqlQuery=(0,o.iH)(""),l.title=(0,o.iH)(""),l.note=(0,o.iH)("");try{const e={user:""};await l.getLibdatAction(e),l.getLibl.forEach((e=>{l.stringOptLibdat.push(e.TABLE_SCHEMA)}))}catch(e){console.log(e)}},G=e=>{A(e)},X=()=>{R(),l.dialog=!0,l.createDialog=!0};return(0,a.bv)((()=>{M()})),(e,t)=>{const s=(0,a.up)("q-btn"),n=(0,a.up)("q-card-section"),d=(0,a.up)("q-separator"),A=(0,a.up)("q-spinner-ios"),M=(0,a.up)("q-tooltip"),H=(0,a.up)("q-avatar"),z=(0,a.up)("q-item-section"),R=(0,a.up)("q-item"),K=(0,a.up)("q-item-label"),Y=(0,a.up)("q-list"),J=(0,a.up)("q-card"),$=(0,a.up)("q-inner-loading"),ee=(0,a.up)("q-icon"),le=(0,a.up)("q-toggle"),te=(0,a.up)("q-input"),ae=(0,a.up)("q-table"),oe=(0,a.up)("q-option-group"),ie=(0,a.up)("q-select"),re=(0,a.up)("q-card-actions"),se=(0,a.up)("q-dialog"),ne=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",u,[(0,a.Wm)(J,{class:"my-card"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s,{color:"primary","text-color":"white",lable:"Crea",onClick:X},{default:(0,a.w5)((()=>[c])),_:1})])),_:1}),(0,a.Wm)(d,{inset:""}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,o.SU)(l).loaderUserQuery?((0,a.wg)(),(0,a.iD)("div",m,[(0,a.Wm)(A,{color:"primary",size:"7em"}),(0,a.Wm)(M,{offset:[0,8]},{default:(0,a.w5)((()=>[p])),_:1})])):((0,a.wg)(),(0,a.j4)(Y,{key:1,bordered:"",separator:"",class:"text-primary text-subtitle2",style:{"max-height":"400px",overflow:"auto"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)((0,o.SU)(l).queriesSaved,(e=>((0,a.wg)(),(0,a.j4)(R,{dense:"",clickable:"",key:e.SQLSTR},{default:(0,a.w5)((()=>[(0,a.Wm)(R,{dense:"",clickable:"",class:"q-mr-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{onClick:l=>G(e.SQLSTR),color:"primary","text-color":"white",icon:"play_arrow"},null,8,["onClick"])])),_:2},1024)])),_:2},1024),(0,a.Wm)(R,{dense:"",clickable:"",class:"q-mr-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(z,{avatar:""},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{onClick:l=>F(e.LIBDAT,e.TITLE),rounded:"",flat:"","text-color":"red",icon:"delete"},null,8,["onClick"])])),_:2},1024)])),_:2},1024),(0,a.Wm)(z,{style:{"max-width":"150px"},onClick:l=>P(e)},{default:(0,a.w5)((()=>[(0,a.Wm)(K,null,{default:(0,a.w5)((()=>[(0,a._)("b",null,(0,i.zw)(e.TITLE),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,a.Wm)(z,{class:"text-left",onClick:l=>P(e)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.SQLSTR),1)])),_:2},1032,["onClick"]),(0,a.Wm)(z,{class:"text-left",onClick:l=>P(e)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e.NOTE),1)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}))])),_:1})])),_:1})]),null!==(0,o.SU)(l).gError?((0,a.wg)(),(0,a.iD)("pre",w,[g,(0,a._)("b",null," errore:  "+(0,i.zw)((0,o.SU)(l).gError)+" ",1),f])):(0,o.SU)(l).queries.length?((0,a.wg)(),(0,a.j4)(ae,{key:1,loading:(0,o.SU)(l).loadingTable,class:"q-mx-xl q-my-lg text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:(0,o.SU)(l).queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"480px"},filter:(0,o.SU)(l).filter,grid:(0,o.SU)(l).grid},{loading:(0,a.w5)((()=>[(0,a.Wm)($,{showing:"",color:"primary"})])),"top-right":(0,a.w5)((()=>[(0,a.Wm)(te,{borderless:"",dense:"",debounce:"300",modelValue:(0,o.SU)(l).filter,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,o.SU)(l).filter=e),placeholder:"Search word"},{append:(0,a.w5)((()=>[(0,a.Wm)(ee,{name:"search",color:"white"}),(0,a.Wm)(le,{color:"red",modelValue:(0,o.SU)(l).grid,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,o.SU)(l).grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["loading","rows","filter","grid"])):(0,a.kq)("",!0),(0,a.Wm)(se,{modelValue:(0,o.SU)(l).dialog,"onUpdate:modelValue":t[10]||(t[10]=e=>(0,o.SU)(l).dialog=e),"transition-show":"rotate","transition-hide":"rotate"},{default:(0,a.w5)((()=>[(0,a.Wm)(J,{style:{width:"1800px","max-width":"90vw",height:"90%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[y])),_:1}),(0,a.Wm)(d),(0,a._)("div",b,[(0,a.Wm)(J,{class:"q-ma-lg"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a._)("div",U,[(0,a._)("div",S,[(0,a.Wm)(te,{dense:"",filled:"",modelValue:(0,o.SU)(l).title,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,o.SU)(l).title=e),label:"Titolo"},null,8,["modelValue"])]),(0,a._)("div",h,[(0,a.Wm)(te,{modelValue:(0,o.SU)(l).sqlQuery,"onUpdate:modelValue":t[3]||(t[3]=e=>(0,o.SU)(l).sqlQuery=e),filled:"",dense:"",autogrow:"",label:"Scrivi la SQL qui"},null,8,["modelValue"])]),(0,a._)("div",_,[(0,a.Wm)(te,{dense:"",modelValue:(0,o.SU)(l).note,"onUpdate:modelValue":t[4]||(t[4]=e=>(0,o.SU)(l).note=e),filled:"",autogrow:"",label:"Note"},null,8,["modelValue"])])])])),_:1})])),_:1}),(0,a.Wm)(J,{class:"q-ma-lg"},{default:(0,a.w5)((()=>[(0,o.SU)(l).createDialog?((0,a.wg)(),(0,a.j4)(n,{key:0,bordered:"",class:"my-card q-mb-xl"},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a._)("div",q,[(0,a.Wm)(oe,{modelValue:T.value,"onUpdate:modelValue":[t[5]||(t[5]=e=>T.value=e),E],options:(0,o.SU)(V).getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","options"])]),(0,a._)("div",x,[(0,a._)("p",W,[(0,a._)("b",null,(0,i.zw)((0,o.SU)(l).select),1)]),(0,a.Wm)(ie,{filled:"",dense:"",modelValue:(0,o.SU)(l).libdatM,"onUpdate:modelValue":[t[6]||(t[6]=e=>(0,o.SU)(l).libdatM=e),O],"use-input":"","input-debounce":"0",label:"Libreria dati",clearable:"",options:(0,o.SU)(l).optionLibdat,onFilter:j,behavior:"menu",style:{"max-width":"150px",height:"10px"}},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a.Wm)(z,{class:"text-grey"},{default:(0,a.w5)((()=>[Q])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,a.Wm)(ie,{filled:"",dense:"","hide-bottom-space":"",loading:(0,o.SU)(l).loadingFileM,modelValue:(0,o.SU)(l).fileM,"onUpdate:modelValue":[t[7]||(t[7]=e=>(0,o.SU)(l).fileM=e),I],"use-input":"","input-debounce":"0",label:"File",clearable:"",options:(0,o.SU)(l).optionFile,onFilter:B,behavior:"menu",style:{"max-width":"280px","max-height":"10px important!"}},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a.Wm)(z,{class:"text-grey"},{default:(0,a.w5)((()=>[k])),_:1})])),_:1})])),_:1},8,["loading","modelValue","options"]),(0,a._)("div",v,[(0,a._)("p",C,(0,i.zw)((0,o.SU)(l).where),1),(0,a.Wm)(le,{disable:!(0,o.SU)(l).fileM,modelValue:(0,o.SU)(l).toggleWhere,"onUpdate:modelValue":[t[8]||(t[8]=e=>(0,o.SU)(l).toggleWhere=e),D],color:"primary"},null,8,["disable","modelValue"])])])])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[(0,a._)("div",L,[(0,a.wy)((0,a.Wm)(ae,{dense:"",title:"Seleziona campi",rows:(0,o.SU)(l).rows,columns:(0,o.SU)(l).columns,"row-key":"COLUMN_TEXT",selection:"multiple",boarderd:"",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"280px"},selected:(0,o.SU)(l).selected,"onUpdate:selected":[t[9]||(t[9]=e=>(0,o.SU)(l).selected=e),Z]},null,8,["rows","columns","selected"]),[[r.F8,(0,o.SU)(l).toggleWhere]])])])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})]),(0,a.Wm)(re,{align:"right"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(s,{disable:""==(0,o.SU)(l).title||""==(0,o.SU)(l).sqlQuery,flat:"",label:"Save",icon:"save",color:"primary",onClick:N},null,8,["disable"]),[[ne]]),(0,a.wy)((0,a.Wm)(s,{flat:"",label:"close",color:"red"},null,512),[[ne]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}};var T=t(151),Z=t(5589),A=t(8240),M=t(5869),E=t(8506),D=t(8870),H=t(7011),I=t(3414),F=t(2035),O=t(5096),z=t(2350),N=t(8107),P=t(6941),j=t(4842),B=t(4554),R=t(8886),G=t(6778),X=t(8758),K=t(4019),Y=t(9367),J=t(6115),$=t(677),ee=t(7518),le=t.n(ee);const te=V,ae=te;le()(V,"components",{QCard:T.Z,QCardSection:Z.Z,QBtn:A.Z,QSeparator:M.Z,QSpinnerIos:E.Z,QTooltip:D.Z,QList:H.Z,QItem:I.Z,QItemSection:F.Z,QAvatar:O.Z,QItemLabel:z.Z,QTable:N.Z,QInnerLoading:P.Z,QInput:j.Z,QIcon:B.Z,QToggle:R.Z,QDialog:G.Z,QOptionGroup:X.Z,QSelect:K.Z,QCardActions:Y.Z,QField:J.Z}),le()(V,"directives",{ClosePopup:$.Z})}}]);