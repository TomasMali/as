"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[604],{604:(e,a,l)=>{l.r(a),l.d(a,{default:()=>R});l(5663),l(5363);var o=l(4852),t=l(4323),i=l(2323),r=(l(6701),l(1907));l(589);const n=(0,r.Q_)("workitem",{state:()=>({wis:[],categories:[],usernames:[],category:(0,t.iH)([]),username:(0,t.iH)([]),categoryOptions:(0,t.iH)([]),optionsC:(0,t.iH)([]),usernameOptions:(0,t.iH)([]),optionsU:(0,t.iH)([]),grid:!1,loading:!1,loadingTable:!1,loadingInputFiles:!1,loadingCat:!1,filter:"",resolved:!0,wiSearch:(0,t.iH)(null),columns:[{name:"ID",label:"ID",field:"ID",sortable:!0,align:"center"},{name:"WORK_ITEM_TYPE",label:"TIPO WORKITEM",field:"WORK_ITEM_TYPE",sortable:!0,align:"left"},{name:"CATEGORIA",label:"CATEGORIA ",field:"CATEGORIA",sortable:!0,align:"left"},{name:"OWNER_ITEM_ID",label:"OWNERD BY",field:"OWNER_ITEM_ID",sortable:!0,align:"left"},{name:"SUMMARY",label:"SUMMARY",field:"SUMMARY",sortable:!0,align:"left"},{name:"INTERNAL_STATE",label:"STATO",field:"INTERNAL_STATE",sortable:!0,align:"left"},{name:"INTERNAL_SEVERITY",label:"INTERNAL_SEVERITY",field:"INTERNAL_SEVERITY",sortable:!0},{name:"INTERNAL_PRIORITY",label:"INTERNAL_PRIORITY",field:"INTERNAL_PRIORITY",sortable:!0},{name:"CREATION_DATE ",label:"CREATION_DATE",field:"CREATION_DATE",sortable:!0},{name:"MODIFIED",label:"MODIFIED_DATE",field:"COLUMODIFIEDMN_DEFAULT",sortable:!0},{name:"RESOLUTION_DATE",label:"RESOLUTION_DATE",field:"RESOLUTION_DATE",sortable:!0}]}),getters:{getCategories:e=>e.categories.map((e=>({label:e.NAME_COL.trim(),val:e.ITEM_ID}))),getUsernames:e=>e.usernames.map((e=>({label:e.USER_COL.trim()}))),getWis:e=>e.wis},actions:{async loadCategories(){let e="http://"+window.location.hostname+":3300/db2/category";const a=await fetch(e,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),l=await a.json();if(!a.ok)throw 409===l.code?new Error(l.message):new Error("Request failed with error code: "+a.status);this.categories=l},async loadUsernames(){let e="http://"+window.location.hostname+":3300/db2/usernames";const a=await fetch(e,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),l=await a.json();if(!a.ok)throw 409===l.code?new Error(l.message):new Error("Request failed with error code: "+a.status);this.usernames=l},async loadWis(e){let a="http://"+window.location.hostname+":3300/db2/wis/?category="+e.category+"&user="+e.user+"&resolved="+e.resolved;const l=await fetch(a,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await l.json();if(!l.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+l.status);this.wis=o},async loadSingleWi(e){let a="http://"+window.location.hostname+":3300/db2/wi/?id="+e;console.log(a);const l=await fetch(a,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await l.json();if(!l.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+l.status);this.wis=o}}});var s=l(2841),d=l(8825);const c={class:"row q-pa-md"},u={class:"q-mx-lg scritta"},m={__name:"Workitems",setup(e){const a=n(),l=(0,t.iH)(null),r=((0,d.Z)(),(e,a)=>{let l=void 0!==a?a(e):e;return l=void 0===l||null===l?"":String(l),l=l.split('"').join('""'),`"${l}"`}),m=()=>{var e=[];l.value.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(l.value.filteredSortedRows[0]));var a=[];e.forEach((e=>{a.push({field:e,name:e,label:e})}));const o=[a.map((e=>r(e.label)))].concat(l.value.filteredSortedRows.map((e=>a.map((a=>r("function"===typeof a.field?a.field(e):e[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n");(0,s.Z)("table-export.csv",o,"text/csv")},p=()=>{w()},w=async()=>{try{var e=[];void 0!=a.category.value&&a.category.value.forEach((a=>{e.push(a.val)}));var l=[];void 0!=a.username.value&&a.username.value.forEach((e=>{l.push(e.label)}));const o={category:e,user:l,resolved:a.resolved?"1":""};a.loading=!0,await a.loadWis(o),a.loading=!1}catch(o){console.log(o)}},g=(e,l)=>{l(""!==e?()=>{const l=e.toLowerCase();a.optionsC.value=a.categoryOptions.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{a.optionsC.value=a.categoryOptions.value})},f=async()=>{a.loadingCat=!0,await a.loadCategories(),a.categoryOptions.value=a.getCategories,a.loadingCat=!1},h=()=>{w()},b=(e,l)=>{l(""!==e?()=>{const l=e.toLowerCase();a.optionsU.value=a.usernameOptions.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{a.optionsU.value=a.usernameOptions.value})},E=async()=>{a.loadingInputFiles=!0,await a.loadUsernames(),a.usernameOptions.value=a.getUsernames,a.loadingInputFiles=!1},T=()=>{w()},v=()=>{S()},S=async()=>{try{a.loading=!0,console.log(a.wiSearch),await a.loadSingleWi(a.wiSearch),a.loading=!1}catch(e){console.log(e)}};function I(){if(a.wiSearch.endsWith(","))return!1;var e=a.wiSearch.replace(",","").trim();return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}return(0,o.bv)((()=>{f(),E(),w()})),(e,r)=>{const n=(0,o.up)("q-item-label"),s=(0,o.up)("q-item-section"),d=(0,o.up)("q-toggle"),w=(0,o.up)("q-item"),f=(0,o.up)("q-select"),E=(0,o.up)("q-icon"),S=(0,o.up)("q-input"),y=(0,o.up)("q-btn"),U=(0,o.up)("q-card-section"),_=(0,o.up)("q-card"),W=(0,o.up)("q-inner-loading"),O=(0,o.up)("q-table");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(_,{bordered:"",class:"q-my-sm q-mx-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{class:""},{default:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o.Wm)(f,{dense:"",class:"q-mr-lg",options:(0,t.SU)(a).optionsC.value,modelValue:(0,t.SU)(a).category.value,"onUpdate:modelValue":[r[0]||(r[0]=e=>(0,t.SU)(a).category.value=e),p],onFilter:g,loading:(0,t.SU)(a).loadingCat,"transition-show":"flip-up","transition-hide":"flip-down",disable:(0,t.SU)(a).loadingCat,"use-input":"","input-debounce":"0",label:"(AREA) Filed Against",clearable:"",multiple:"","emit-value":"","map-options":""},{option:(0,o.w5)((({itemProps:e,opt:a,selected:l,toggleOption:t})=>[(0,o.Wm)(w,(0,i.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,{innerHTML:a.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(s,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{"model-value":l,"onUpdate:modelValue":e=>t(a)},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:2},1040)])),"no-option":(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"text-grey"},{default:(0,o.w5)((()=>[(0,o.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["options","modelValue","loading","disable"]),(0,o.Wm)(f,{class:"q-ml-md",options:(0,t.SU)(a).optionsU.value,modelValue:(0,t.SU)(a).username.value,"onUpdate:modelValue":[r[1]||(r[1]=e=>(0,t.SU)(a).username.value=e),h],onFilter:b,dense:"","use-input":"",loading:(0,t.SU)(a).loadingInputFiles,"transition-show":"flip-up","transition-hide":"flip-down",disable:(0,t.SU)(a).loadingInputFiles,"input-debounce":"0",label:"Owned By",autofocus:"",clearable:"",multiple:"","emit-value":"","map-options":""},{option:(0,o.w5)((({itemProps:e,opt:a,selected:l,toggleOption:t})=>[(0,o.Wm)(w,(0,i.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,{innerHTML:a.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(s,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{"model-value":l,"onUpdate:modelValue":e=>t(a)},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:2},1040)])),"no-option":(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"text-grey"},{default:(0,o.w5)((()=>[(0,o.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["options","modelValue","loading","disable"]),(0,o._)("div",u,[(0,o.Wm)(d,{dense:"",modelValue:(0,t.SU)(a).resolved,"onUpdate:modelValue":[r[2]||(r[2]=e=>(0,t.SU)(a).resolved=e),T],size:"xl",icon:"visibility",label:"Opened",color:"purple"},null,8,["modelValue"])]),(0,o.Wm)(S,{class:"q-mr-sm",dense:"",square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:(0,t.SU)(a).wiSearch,"onUpdate:modelValue":r[3]||(r[3]=e=>(0,t.SU)(a).wiSearch=e),label:"Search one or a list of WI"},{append:(0,o.w5)((()=>[(0,o.Wm)(E,{name:"bolt",color:"primary"})])),_:1},8,["modelValue"]),(0,o.Wm)(y,{dense:"",inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:v,disable:null==(0,t.SU)(a).wiSearch||""==(0,t.SU)(a).wiSearch||!I()},null,8,["disable"])])])),_:1})])),_:1}),(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white ",rows:(0,t.SU)(a).getWis,columns:(0,t.SU)(a).columns,"row-key":"indwiStore.getWis.ID",dense:"","auto-width":"",grid:(0,t.SU)(a).grid,loading:(0,t.SU)(a).loading,boarderd:"",title:"Risultato Workitems",separator:"cell",style:{height:"720px"},filter:(0,t.SU)(a).filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18],ref_key:"tabCol",ref:l},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(S,{borderless:"",dense:"",debounce:"300",modelValue:(0,t.SU)(a).filter,"onUpdate:modelValue":r[5]||(r[5]=e=>(0,t.SU)(a).filter=e),placeholder:"Search"},{append:(0,o.w5)((()=>[(0,o.Wm)(E,{name:"search",color:"white"}),(0,o.Wm)(d,{modelValue:(0,t.SU)(a).grid,"onUpdate:modelValue":r[4]||(r[4]=e=>(0,t.SU)(a).grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,o.Wm)(y,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:m})])),loading:(0,o.w5)((()=>[(0,o.Wm)(W,{showing:"",color:"primary"})])),_:1},8,["rows","columns","grid","loading","filter"])])),_:1})])),_:1})])}}};var p=l(151),w=l(5589),g=l(3017),f=l(3414),h=l(2035),b=l(2350),E=l(8886),T=l(4842),v=l(4554),S=l(8240),I=l(8107),y=l(6941),U=l(6115),_=l(7518),W=l.n(_);const O=m,R=O;W()(m,"components",{QCard:p.Z,QCardSection:w.Z,QSelect:g.Z,QItem:f.Z,QItemSection:h.Z,QItemLabel:b.Z,QToggle:E.Z,QInput:T.Z,QIcon:v.Z,QBtn:S.Z,QTable:I.Z,QInnerLoading:y.Z,QField:U.Z})}}]);