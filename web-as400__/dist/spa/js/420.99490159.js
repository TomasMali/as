"use strict";(self["webpackChunkweb_as400"]=self["webpackChunkweb_as400"]||[]).push([[420],{420:(e,l,t)=>{t.r(l),t.d(l,{default:()=>I});var a=t(3673);const i={class:"q-pa-md"},o={key:0,class:"q-pa-lg text-h6"},r={class:"q-gutter-md row"},s=(0,a.Uk)("No results"),n=(0,a.Uk)("No results"),d={class:"q-ml-lg scritta"},u={inline:"",class:"flex flex-left"};function c(e,l,t,c,m,h){const g=(0,a.up)("q-option-group"),p=(0,a.up)("q-item-section"),f=(0,a.up)("q-item"),b=(0,a.up)("q-select"),w=(0,a.up)("q-toggle"),y=(0,a.up)("q-icon"),q=(0,a.up)("q-input"),E=(0,a.up)("q-btn"),A=(0,a.up)("q-checkbox"),S=(0,a.up)("q-card-section"),_=(0,a.up)("q-card"),U=(0,a.up)("q-table"),N=(0,a.up)("q-inner-loading");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(_,{class:"q-my-md"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"q-py-lg q-px-lg"},{default:(0,a.w5)((()=>[m.pref.getUserPrefAsObj.length>0?((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(g,{modelValue:m.group,"onUpdate:modelValue":[l[0]||(l[0]=e=>m.group=e),h.onGroupChange],options:m.pref.getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","onUpdate:modelValue","options"])])):(0,a.kq)("",!0),(0,a._)("div",r,[(0,a.Wm)(b,{filled:"",modelValue:m.model,"onUpdate:modelValue":[l[1]||(l[1]=e=>m.model=e),h.onClickLibdat],"use-input":"","input-debounce":"0",label:"LIBDAT",clearable:"",options:m.options,onFilter:h.filterFn,behavior:"menu"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"text-grey"},{default:(0,a.w5)((()=>[s])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue"]),(0,a.Wm)(b,{filled:"",modelValue:m.fileNameModel,"onUpdate:modelValue":[l[2]||(l[2]=e=>m.fileNameModel=e),h.onClickFilename],"use-input":"",loading:m.loadingInputFiles,disable:m.loadingInputFiles,"input-debounce":"0",label:"FILE",autofocus:"",clearable:"",options:m.fileNamesOptions,onFilter:h.filterFileNames,behavior:"menu"},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"text-grey"},{default:(0,a.w5)((()=>[n])),_:1})])),_:1})])),_:1},8,["modelValue","loading","disable","options","onFilter","onUpdate:modelValue"]),(0,a._)("div",d,[(0,a.Wm)(w,{modelValue:m.queryToggle,"onUpdate:modelValue":l[3]||(l[3]=e=>m.queryToggle=e),size:"xl",icon:"visibility",label:"Query first 5000 Records",color:"red"},null,8,["modelValue"])]),(0,a._)("div",u,[(0,a.Wm)(q,{style:{"min-width":"200px"},square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:m.fastWordSearch,"onUpdate:modelValue":l[4]||(l[4]=e=>m.fastWordSearch=e),label:"Fast Search"},{append:(0,a.w5)((()=>[(0,a.Wm)(y,{name:"bolt",color:"primary"})])),_:1},8,["modelValue"]),(0,a.Wm)(E,{loading:m.loading,inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:h.fastSearch,disable:null==m.fastWordSearch||""==m.fastWordSearch||m.fastWordSearch.length<3},null,8,["loading","onClick","disable"]),(0,a.Wm)(A,{class:"q-ml-xl",size:"lg","left-label":"",modelValue:m.deep,"onUpdate:modelValue":l[5]||(l[5]=e=>m.deep=e),label:"Ricerca profonda"},null,8,["modelValue"])])])])),_:1})])),_:1}),m.queryToggle||m.queryStr.launchQueryPrefered?m.queryToggle&&!m.queryStr.launchQueryPrefered?((0,a.wg)(),(0,a.j4)(U,{key:1,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",rows:m.queries,"row-key":"index",dense:"","auto-width":"",grid:m.grid,loading:m.loading,boarderd:"",title:m.fileNameModel,separator:"cell",style:{height:"640px"},filter:m.filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18]},{"top-right":(0,a.w5)((()=>[(0,a.Wm)(q,{borderless:"",dense:"",debounce:"300",modelValue:m.filter,"onUpdate:modelValue":l[9]||(l[9]=e=>m.filter=e),placeholder:"Search"},{append:(0,a.w5)((()=>[(0,a.Wm)(y,{name:"search",color:"white"}),(0,a.Wm)(w,{modelValue:m.grid,"onUpdate:modelValue":l[8]||(l[8]=e=>m.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["rows","grid","loading","title","filter"])):m.queryStr.queries.length?((0,a.wg)(),(0,a.j4)(U,{key:2,loading:m.queryStr.loadingTable,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:m.queryStr.queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:m.queryStr.filter,grid:m.queryStr.grid},{loading:(0,a.w5)((()=>[(0,a.Wm)(N,{showing:"",color:"primary"})])),"top-right":(0,a.w5)((()=>[(0,a.Wm)(q,{borderless:"",dense:"",debounce:"300",modelValue:m.queryStr.filter,"onUpdate:modelValue":l[11]||(l[11]=e=>m.queryStr.filter=e),placeholder:"Search word"},{append:(0,a.w5)((()=>[(0,a.Wm)(y,{name:"search",color:"white"}),(0,a.Wm)(w,{color:"red",modelValue:m.queryStr.grid,"onUpdate:modelValue":l[10]||(l[10]=e=>m.queryStr.grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["loading","rows","filter","grid"])):(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(U,{key:0,dense:"","auto-width":"",class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",grid:m.grid,rows:m.rows,columns:m.columns,"row-key":"name",loading:m.loading,boarderd:"",title:m.fileNameModel,separator:"cell",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:m.filter},{"top-right":(0,a.w5)((()=>[(0,a.Wm)(q,{borderless:"",dense:"",debounce:"300",modelValue:m.filter,"onUpdate:modelValue":l[7]||(l[7]=e=>m.filter=e),placeholder:"Search word"},{append:(0,a.w5)((()=>[(0,a.Wm)(y,{name:"search",color:"white"}),(0,a.Wm)(w,{modelValue:m.grid,"onUpdate:modelValue":l[6]||(l[6]=e=>m.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,a.Wm)(E,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:h.exportTable},null,8,["onClick"])])),_:1},8,["grid","rows","columns","loading","title","filter"]))])}var m=t(1959),h=t(2841),g=t(8825),p=t(6041),f=t(1390),b=t(5214);const w={data(){return{q:(0,g.Z)(),as:null,pref:null,queryStr:null,fastWordSearch:"",deep:!1,queries:[],queryToggle:!1,launchQueryPrefered:!1,pagination:{rowsPerPage:0},group:(0,m.iH)(""),loadingInputFiles:!1,model:null,stringOptions:[],options:this.stringOptions,fileNameModel:null,filenamesArray:[],fileNamesOptions:this.filenamesArray,separator:"vertical",filter:"",grid:!1,loading:!1,fileName:"ROLE_USER",lib:"WRKJEXP",rows:[],columns:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}]}},methods:{exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.rows.map((e=>this.columns.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,h.Z)("table-export.csv",e,"text/csv")},wrapCsvValue(e,l){let t=void 0!==l?l(e):e;return t=void 0===t||null===t?"":String(t),t=t.split('"').join('""'),`"${t}"`},async loadFilenames(){try{const e={filename:this.model};this.loadingInputFiles=!0,await this.as.getFilenamesAction(e),this.filenamesArray=[],this.as.getFilenames.forEach((e=>{this.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),this.loadingInputFiles=!1}catch(e){console.log(e)}},async loadLibdat(){try{const e={user:""};await this.pref.setUserPref(this.q.localStorage.getItem("currentUser")),await this.pref.getUserPrefAsObj.length>0&&(this.group=this.pref.getUserPrefAsObj[0].value,this.model=this.group),await this.as.getUsersAction(e),await this.as.getUsers.forEach((e=>{this.stringOptions.push(e.TABLE_SCHEMA)})),this.loadFilenames()}catch(e){console.log(e)}},async loadFiles(){if(this.fileNameModel){this.loading=!0,this.rows=[];try{const e={lib:this.model,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},async loadQueries(){if(this.fileNameModel){this.loading=!0,this.queries=[];try{const e={lib:this.model,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getQueriesAction(e),this.queries=this.as.getQueries,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},async loadFastFiles(){if(""!==this.fastWordSearch){this.loading=!0,this.rows=[];try{const e={user:null!=this.q.localStorage.getItem("currentUser")&&""!=this.q.localStorage.getItem("currentUser")?this.q.localStorage.getItem("currentUser").trim():"",search_word:this.fastWordSearch.trim(),all:this.deep?"all":"no"};await this.as.getFastFilesAction(e),this.rows=this.as.getFastFiles,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},onClickLibdat(e){this.loadFilenames(),this.fileNameModel=null},onClickFilename(e){this.loadFiles(),this.filter="",this.queryStr.launchQueryPrefered=!1},filterFileNames(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.fileNamesOptions=this.filenamesArray.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.fileNamesOptions=this.filenamesArray})},filterFn(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.options=this.stringOptions.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.options=this.stringOptions})},fastSearch(){this.loadFastFiles()},onGroupChange(){this.model=this.group,this.loadFilenames(),this.fileNameModel=null}},watch:{queryToggle(e,l){e&&(this.loadQueries(),this.queryStr.launchQueryPrefered=!1)},fileNameModel(e,l){""!==e&&null!=this.fileNameModel&&this.queryToggle&&this.loadQueries()},fastWordSearch(e,l){}},created(){this.as=(0,f.o)(),this.pref=(0,b.H)(),this.queryStr=(0,p.U)(),this.loadLibdat()}};var y=t(4260),q=t(151),E=t(5589),A=t(8758),S=t(4019),_=t(3414),U=t(2035),N=t(8886),C=t(4842),V=t(4554),L=t(8240),M=t(5735),T=t(8107),F=t(6941),W=t(7518),x=t.n(W);const O=(0,y.Z)(w,[["render",c]]),I=O;x()(w,"components",{QCard:q.Z,QCardSection:E.Z,QOptionGroup:A.Z,QSelect:S.Z,QItem:_.Z,QItemSection:U.Z,QToggle:N.Z,QInput:C.Z,QIcon:V.Z,QBtn:L.Z,QCheckbox:M.Z,QTable:T.Z,QInnerLoading:F.Z})}}]);