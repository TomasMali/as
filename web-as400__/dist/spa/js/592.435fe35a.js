"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[592],{1592:(e,l,a)=>{a.r(l),a.d(l,{default:()=>x});var t=a(3673);const i={class:""},o={class:"row q-mb-md"},s={key:0,class:"col q-mr-md",style:{"border-style":"ridge"}},r={class:"col flex q-pa-md",style:{"border-style":"ridge"}},n={class:"row q-pa-md",style:{"border-style":"ridge"}},d={class:"q-ml-lg scritta"};function m(e,l,a,m,u,c){const h=(0,t.up)("q-option-group"),g=(0,t.up)("q-icon"),f=(0,t.up)("q-input"),p=(0,t.up)("q-btn"),b=(0,t.up)("q-checkbox"),E=(0,t.up)("q-item-section"),A=(0,t.up)("q-item"),T=(0,t.up)("q-select"),w=(0,t.up)("q-toggle"),_=(0,t.up)("q-card-section"),y=(0,t.up)("q-card"),L=(0,t.up)("q-inner-loading"),N=(0,t.up)("q-table");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t.Wm)(y,{bordered:"",class:"q-my-sm q-mx-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{class:""},{default:(0,t.w5)((()=>[(0,t._)("div",o,[u.pref.getUserPrefAsObj.length>0?((0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(h,{class:"q-mt-md",modelValue:u.group,"onUpdate:modelValue":[l[0]||(l[0]=e=>u.group=e),c.onGroupChange],options:u.pref.getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","onUpdate:modelValue","options"])])):(0,t.kq)("",!0),(0,t._)("div",r,[(0,t.Wm)(f,{dense:"",style:{width:"170px"},square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:u.fastWordSearch,"onUpdate:modelValue":l[1]||(l[1]=e=>u.fastWordSearch=e),label:"Fast Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(g,{name:"bolt",color:"primary"})])),_:1},8,["modelValue"]),(0,t.Wm)(p,{dense:"",loading:u.loading,inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:c.fastSearch,disable:null==u.fastWordSearch||""==u.fastWordSearch||u.fastWordSearch.length<3},null,8,["loading","onClick","disable"]),(0,t.Wm)(b,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:u.searchFile,"onUpdate:modelValue":l[2]||(l[2]=e=>u.searchFile=e),label:"Cerca File"},null,8,["modelValue"]),(0,t.Wm)(b,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:u.deep,"onUpdate:modelValue":l[3]||(l[3]=e=>u.deep=e),label:"Ricerca profonda"},null,8,["modelValue"])])]),(0,t._)("div",n,[(0,t.Wm)(T,{dense:"",filled:"",modelValue:u.model,"onUpdate:modelValue":[l[4]||(l[4]=e=>u.model=e),c.onClickLibdat],"use-input":"","input-debounce":"0",label:"LIBDAT",clearable:"",options:u.options,onFilter:c.filterFn,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(E,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue"]),(0,t.Wm)(T,{class:"q-ml-md",style:{"max-height":"500px"},dense:"",filled:"",modelValue:u.fileNameModel,"onUpdate:modelValue":[l[5]||(l[5]=e=>u.fileNameModel=e),c.onClickFilename],"use-input":"",loading:u.loadingInputFiles,disable:u.loadingInputFiles,"input-debounce":"0",label:"FILE",autofocus:"",clearable:"",options:u.fileNamesOptions,onFilter:c.filterFileNames,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(E,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","loading","disable","options","onFilter","onUpdate:modelValue"]),(0,t._)("div",d,[(0,t.Wm)(w,{dense:"",modelValue:u.queryToggle,"onUpdate:modelValue":l[6]||(l[6]=e=>u.queryToggle=e),size:"xl",icon:"visibility",label:"Show 500",color:"red"},null,8,["modelValue"])])])])),_:1})])),_:1}),u.queryToggle||u.queryStr.launchQueryPrefered?u.queryToggle&&!u.queryStr.launchQueryPrefered?((0,t.wg)(),(0,t.j4)(N,{key:1,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",rows:u.queries,"row-key":"index",dense:"","auto-width":"",grid:u.grid,loading:u.loading,boarderd:"",title:u.fileNameModel,separator:"cell",style:{height:"640px"},filter:u.filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18]},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(f,{borderless:"",dense:"",debounce:"300",modelValue:u.filter,"onUpdate:modelValue":l[10]||(l[10]=e=>u.filter=e),placeholder:"Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(g,{name:"search",color:"white"}),(0,t.Wm)(w,{modelValue:u.grid,"onUpdate:modelValue":l[9]||(l[9]=e=>u.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["rows","grid","loading","title","filter"])):u.queryStr.queries.length?((0,t.wg)(),(0,t.j4)(N,{key:2,loading:u.queryStr.loadingTable,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:u.queryStr.queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:u.queryStr.filter,grid:u.queryStr.grid},{loading:(0,t.w5)((()=>[(0,t.Wm)(L,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(f,{borderless:"",dense:"",debounce:"300",modelValue:u.queryStr.filter,"onUpdate:modelValue":l[12]||(l[12]=e=>u.queryStr.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(g,{name:"search",color:"white"}),(0,t.Wm)(w,{color:"red",modelValue:u.queryStr.grid,"onUpdate:modelValue":l[11]||(l[11]=e=>u.queryStr.grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["loading","rows","filter","grid"])):(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(N,{key:0,loading:u.loadingTable,dense:"","auto-width":"",class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",grid:u.grid,rows:u.rows,columns:u.columns,"row-key":"name",boarderd:"",title:u.fileNameModel,separator:"cell",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:u.filter,ref:"tb"},{loading:(0,t.w5)((()=>[(0,t.Wm)(L,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(g,{name:"search",size:"sm",class:"q-mr-sm",color:"white"}),(0,t.Wm)(f,{class:"",borderless:"",dense:"",modelValue:u.filter,"onUpdate:modelValue":l[8]||(l[8]=e=>u.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:u.grid,"onUpdate:modelValue":l[7]||(l[7]=e=>u.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(p,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:c.exportTable},null,8,["onClick"])])),_:1},8,["loading","grid","rows","columns","title","filter"]))])}a(5663);var u=a(1959),c=a(2841),h=a(8825),g=a(6041),f=a(1390),p=a(5214),b=a(9889),E=a(1965);const A={data(){return{q:(0,h.Z)(),as:null,pref:null,queryStr:null,voice:null,fastWordSearch:"",deep:!1,searchFile:!1,queries:[],queryToggle:!1,launchQueryPrefered:!1,pagination:{rowsPerPage:0},group:(0,u.iH)(""),loadingInputFiles:!1,model:null,stringOptions:[],options:this.stringOptions,fileNameModel:null,filenamesArray:[],fileNamesOptions:this.filenamesArray,separator:"vertical",filter:"",grid:!1,loading:!1,loadingTable:!1,fileName:"ROLE_USER",lib:"WRKJEXP",rows:[],columns:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}]}},methods:{voiceChanged(){},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.columns.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,c.Z)("table-export.csv",e,"text/csv")},wrapCsvValue(e,l){let a=void 0!==l?l(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`},async loadFilenames(){try{const e={filename:this.model};this.loadingInputFiles=!0,await this.as.getFilenamesAction(e),this.filenamesArray=[],this.as.getFilenames.forEach((e=>{this.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),this.loadingInputFiles=!1}catch(e){console.log(e)}},async loadLibdat(){try{const e={user:""};await this.pref.setUserPref(this.q.localStorage.getItem("currentUser")),await this.pref.getUserPrefAsObj.length>0&&(this.group=this.pref.getUserPrefAsObj[0].value,this.model=this.group),await this.as.getUsersAction(e),await this.as.getUsers.forEach((e=>{this.stringOptions.push(e.TABLE_SCHEMA)})),this.loadFilenames()}catch(e){console.log(e)}},async loadFiles(){if(this.fileNameModel){this.loadingTable=!0,this.rows=[];try{const e={lib:this.model,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(e){console.log(e),this.loadingTable=!1}}},async loadQueries(){if(this.fileNameModel){this.loading=!0,this.queries=[];try{const e={lib:this.model,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getQueriesAction(e),this.queries=this.as.getQueries,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},async loadFastFiles(){if(""!==this.fastWordSearch){this.loading=!0,this.rows=[];try{const e={user:null!=this.q.localStorage.getItem("currentUser")&&""!=this.q.localStorage.getItem("currentUser")?this.q.localStorage.getItem("currentUser").trim():"",search_word:this.fastWordSearch.trim(),all:this.deep?"all":"no",searchFile:this.searchFile?"true":"false"};await this.as.getFastFilesAction(e),this.rows=this.as.getFastFiles,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},onClickLibdat(e){this.loadFilenames(),this.fileNameModel=null},onClickFilename(e){this.loadFiles(),this.filter="",this.queryStr.launchQueryPrefered=!1},filterFileNames(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.fileNamesOptions=this.filenamesArray.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.fileNamesOptions=this.filenamesArray})},filterFn(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.options=this.stringOptions.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.options=this.stringOptions})},fastSearch(){this.loadFastFiles()},onGroupChange(){this.model=this.group,this.loadFilenames(),this.fileNameModel=null}},watch:{queryToggle(e,l){e&&(this.loadQueries(),this.queryStr.launchQueryPrefered=!1)},fileNameModel(e,l){""!==e&&null!=this.fileNameModel&&this.queryToggle&&this.loadQueries()},fastWordSearch(e,l){},searchFile(e,l){this.columns=e?[{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"TABLE_TEXT",label:"TABLE_TEXT",field:"TABLE_TEXT",sortable:!0,align:"center"},{name:"TABLE_DEFINER",label:"TABLE_DEFINER",field:"TABLE_DEFINER",sortable:!0,align:"center"}]:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}]}},created(){this.as=(0,f.o)(),this.pref=(0,p.H)(),this.queryStr=(0,g.U)(),this.loadLibdat(),this.voice=(0,b._)()},components:{Voice:E.Z}};var T=a(4260),w=a(151),_=a(5589),y=a(8758),L=a(4842),N=a(4554),C=a(8240),M=a(5735),U=a(3017),q=a(3414),S=a(2035),F=a(8886),I=a(8107),V=a(6941),O=a(7518),R=a.n(O);const W=(0,T.Z)(A,[["render",m]]),x=W;R()(A,"components",{QCard:w.Z,QCardSection:_.Z,QOptionGroup:y.Z,QInput:L.Z,QIcon:N.Z,QBtn:C.Z,QCheckbox:M.Z,QSelect:U.Z,QItem:q.Z,QItemSection:S.Z,QToggle:F.Z,QTable:I.Z,QInnerLoading:V.Z})}}]);