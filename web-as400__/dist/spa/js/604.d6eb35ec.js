"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[604],{604:(e,l,a)=>{a.r(l),a.d(l,{default:()=>O});a(5663),a(5363);var o=a(3673),t=a(1959),i=a(2323),r=(a(6701),a(1907));a(589);const n=(0,r.Q_)("workitem",{state:()=>({wis:[],categories:[],usernames:[],category:(0,t.iH)([]),username:(0,t.iH)([]),categoryOptions:(0,t.iH)([]),optionsC:(0,t.iH)([]),usernameOptions:(0,t.iH)([]),optionsU:(0,t.iH)([]),grid:!1,loading:!1,loadingTable:!1,loadingInputFiles:!1,loadingCat:!1,filter:"",resolved:!1,wiSearch:(0,t.iH)(null),columns:[{name:"ID",label:"ID",field:"ID",sortable:!0,align:"center"},{name:"WORK_ITEM_TYPE",label:"TIPO WORKITEM",field:"WORK_ITEM_TYPE",sortable:!0,align:"left"},{name:"CATEGORIA",label:"CATEGORIA ",field:"CATEGORIA",sortable:!0,align:"left"},{name:"OWNER_ITEM_ID",label:"OWNERD BY",field:"OWNER_ITEM_ID",sortable:!0,align:"left"},{name:"SUMMARY",label:"SUMMARY",field:"SUMMARY",sortable:!0,align:"left"},{name:"INTERNAL_STATE",label:"STATO",field:"INTERNAL_STATE",sortable:!0,align:"left"},{name:"INTERNAL_SEVERITY",label:"INTERNAL_SEVERITY",field:"INTERNAL_SEVERITY",sortable:!0},{name:"INTERNAL_PRIORITY",label:"INTERNAL_PRIORITY",field:"INTERNAL_PRIORITY",sortable:!0},{name:"CREATION_DATE ",label:"CREATION_DATE",field:"CREATION_DATE",sortable:!0},{name:"MODIFIED",label:"MODIFIED_DATE",field:"COLUMODIFIEDMN_DEFAULT",sortable:!0},{name:"RESOLUTION_DATE",label:"RESOLUTION_DATE",field:"RESOLUTION_DATE",sortable:!0}]}),getters:{getCategories:e=>e.categories.map((e=>({label:e.NAME_COL.trim(),val:e.ITEM_ID}))),getUsernames:e=>e.usernames.map((e=>({label:e.USER_COL.trim()}))),getWis:e=>e.wis},actions:{async loadCategories(){let e="http://"+window.location.hostname+":3300/db2/category";const l=await fetch(e,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),a=await l.json();if(!l.ok)throw 409===a.code?new Error(a.message):new Error("Request failed with error code: "+l.status);this.categories=a},async loadUsernames(){let e="http://"+window.location.hostname+":3300/db2/usernames";const l=await fetch(e,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),a=await l.json();if(!l.ok)throw 409===a.code?new Error(a.message):new Error("Request failed with error code: "+l.status);this.usernames=a},async loadWis(e){let l="http://"+window.location.hostname+":3300/db2/wis/?category="+e.category+"&user="+e.user+"&resolved="+e.resolved;const a=await fetch(l,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await a.json();if(!a.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+a.status);this.wis=o},async loadSingleWi(e){let l="http://"+window.location.hostname+":3300/db2/wi/?id="+e;console.log(l);const a=await fetch(l,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await a.json();if(!a.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+a.status);this.wis=o}}});var s=a(2841),d=a(8825);const c={class:"row q-pa-md"},u={class:"q-mx-lg scritta"},m={__name:"Workitems",setup(e){const l=n(),a=(0,t.iH)(null),r=((0,d.Z)(),(e,l)=>{let a=void 0!==l?l(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`}),m=()=>{var e=[];a.value.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(a.value.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const o=[l.map((e=>r(e.label)))].concat(a.value.filteredSortedRows.map((e=>l.map((l=>r("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,s.Z)("table-export.csv",o,"text/csv")},p=()=>{w()},w=async()=>{try{var e=[];void 0!=l.category.value&&l.category.value.forEach((l=>{e.push(l.val)}));var a=[];void 0!=l.username.value&&l.username.value.forEach((e=>{a.push(e.label)}));const o={category:e,user:a,resolved:l.resolved?"1":""};l.loading=!0,await l.loadWis(o),l.loading=!1}catch(o){console.log(o)}},g=(e,a)=>{a(""!==e?()=>{const a=e.toLowerCase();l.optionsC.value=l.categoryOptions.value.filter((e=>e.label.toLowerCase().indexOf(a)>-1))}:()=>{l.optionsC.value=l.categoryOptions.value})},f=async()=>{l.loadingCat=!0,await l.loadCategories(),l.categoryOptions.value=l.getCategories,l.loadingCat=!1},h=()=>{w()},b=(e,a)=>{a(""!==e?()=>{const a=e.toLowerCase();l.optionsU.value=l.usernameOptions.value.filter((e=>e.label.toLowerCase().indexOf(a)>-1))}:()=>{l.optionsU.value=l.usernameOptions.value})},E=async()=>{l.loadingInputFiles=!0,await l.loadUsernames(),l.usernameOptions.value=l.getUsernames,l.loadingInputFiles=!1},v=()=>{w()},T=()=>{S()},S=async()=>{try{l.loading=!0,console.log(l.wiSearch),await l.loadSingleWi(l.wiSearch),l.loading=!1}catch(e){console.log(e)}};function I(){if(l.wiSearch.endsWith(","))return!1;var e=l.wiSearch.replace(",","").trim();return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}return(0,o.bv)((()=>{f(),E(),w()})),(e,r)=>{const n=(0,o.up)("q-item-label"),s=(0,o.up)("q-item-section"),d=(0,o.up)("q-toggle"),w=(0,o.up)("q-item"),f=(0,o.up)("q-select"),E=(0,o.up)("q-icon"),S=(0,o.up)("q-input"),y=(0,o.up)("q-btn"),U=(0,o.up)("q-card-section"),_=(0,o.up)("q-card"),W=(0,o.up)("q-inner-loading"),R=(0,o.up)("q-table");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(_,{bordered:"",class:"q-my-sm q-mx-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{class:""},{default:(0,o.w5)((()=>[(0,o._)("div",c,[(0,o.Wm)(f,{dense:"",class:"q-mr-lg",options:(0,t.SU)(l).optionsC.value,modelValue:(0,t.SU)(l).category.value,"onUpdate:modelValue":[r[0]||(r[0]=e=>(0,t.SU)(l).category.value=e),p],onFilter:g,loading:(0,t.SU)(l).loadingCat,"transition-show":"flip-up","transition-hide":"flip-down",disable:(0,t.SU)(l).loadingCat,"use-input":"","input-debounce":"0",label:"(AREA) Filed Against",clearable:"",multiple:"","emit-value":"","map-options":""},{option:(0,o.w5)((({itemProps:e,opt:l,selected:a,toggleOption:t})=>[(0,o.Wm)(w,(0,i.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,{innerHTML:l.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(s,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{"model-value":a,"onUpdate:modelValue":e=>t(l)},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:2},1040)])),"no-option":(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"text-grey"},{default:(0,o.w5)((()=>[(0,o.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["options","modelValue","loading","disable"]),(0,o.Wm)(f,{class:"q-ml-md",options:(0,t.SU)(l).optionsU.value,modelValue:(0,t.SU)(l).username.value,"onUpdate:modelValue":[r[1]||(r[1]=e=>(0,t.SU)(l).username.value=e),h],onFilter:b,dense:"","use-input":"",loading:(0,t.SU)(l).loadingInputFiles,"transition-show":"flip-up","transition-hide":"flip-down",disable:(0,t.SU)(l).loadingInputFiles,"input-debounce":"0",label:"Owned By",autofocus:"",clearable:"",multiple:"","emit-value":"","map-options":""},{option:(0,o.w5)((({itemProps:e,opt:l,selected:a,toggleOption:t})=>[(0,o.Wm)(w,(0,i.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(n,{innerHTML:l.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(s,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{"model-value":a,"onUpdate:modelValue":e=>t(l)},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:2},1040)])),"no-option":(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{class:"text-grey"},{default:(0,o.w5)((()=>[(0,o.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["options","modelValue","loading","disable"]),(0,o._)("div",u,[(0,o.Wm)(d,{dense:"",modelValue:(0,t.SU)(l).resolved,"onUpdate:modelValue":[r[2]||(r[2]=e=>(0,t.SU)(l).resolved=e),v],size:"xl",icon:"visibility",label:"Resolved",color:"purple"},null,8,["modelValue"])]),(0,o.Wm)(S,{class:"q-mr-sm",dense:"",square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:(0,t.SU)(l).wiSearch,"onUpdate:modelValue":r[3]||(r[3]=e=>(0,t.SU)(l).wiSearch=e),label:"Search one or a list of WI"},{append:(0,o.w5)((()=>[(0,o.Wm)(E,{name:"bolt",color:"primary"})])),_:1},8,["modelValue"]),(0,o.Wm)(y,{dense:"",inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:T,disable:null==(0,t.SU)(l).wiSearch||""==(0,t.SU)(l).wiSearch||!I()},null,8,["disable"])])])),_:1})])),_:1}),(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o.Wm)(R,{class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white ",rows:(0,t.SU)(l).getWis,columns:(0,t.SU)(l).columns,"row-key":"indwiStore.getWis.ID",dense:"","auto-width":"",grid:(0,t.SU)(l).grid,loading:(0,t.SU)(l).loading,boarderd:"",title:"Risultato Workitems",separator:"cell",style:{height:"720px"},filter:(0,t.SU)(l).filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18],ref_key:"tabCol",ref:a},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(S,{borderless:"",dense:"",debounce:"300",modelValue:(0,t.SU)(l).filter,"onUpdate:modelValue":r[5]||(r[5]=e=>(0,t.SU)(l).filter=e),placeholder:"Search"},{append:(0,o.w5)((()=>[(0,o.Wm)(E,{name:"search",color:"white"}),(0,o.Wm)(d,{modelValue:(0,t.SU)(l).grid,"onUpdate:modelValue":r[4]||(r[4]=e=>(0,t.SU)(l).grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,o.Wm)(y,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:m})])),loading:(0,o.w5)((()=>[(0,o.Wm)(W,{showing:"",color:"primary"})])),_:1},8,["rows","columns","grid","loading","filter"])])),_:1})])),_:1})])}}};var p=a(151),w=a(5589),g=a(3017),f=a(3414),h=a(2035),b=a(2350),E=a(8886),v=a(4842),T=a(4554),S=a(8240),I=a(8107),y=a(6941),U=a(6115),_=a(7518),W=a.n(_);const R=m,O=R;W()(m,"components",{QCard:p.Z,QCardSection:w.Z,QSelect:g.Z,QItem:f.Z,QItemSection:h.Z,QItemLabel:b.Z,QToggle:E.Z,QInput:v.Z,QIcon:T.Z,QBtn:S.Z,QTable:I.Z,QInnerLoading:y.Z,QField:U.Z})}}]);