"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[604],{604:(e,a,l)=>{l.r(a),l.d(a,{default:()=>A});l(5663);var o=l(3673),t=l(1959),r=l(2323),n=l(8880),i=l(1907),s=l(589);const d=(0,i.Q_)("workitem",{state:()=>({wis:[],categories:[],usernames:[],category:(0,t.iH)([]),username:(0,t.iH)([]),categoryOptions:(0,t.iH)([]),optionsC:(0,t.iH)([]),usernameOptions:(0,t.iH)([]),optionsU:(0,t.iH)([]),grid:!1,loading:!1,loadingTable:!1,loadingInputFiles:!1,loadingCat:!1,filter:"",resolved:!0,wiSearch:(0,t.iH)(null),columns:[{name:"ID",label:"ID",field:"ID",sortable:!0,align:"center"},{name:"WORK_ITEM_TYPE",label:"TIPO WORKITEM",field:"WORK_ITEM_TYPE",sortable:!0,align:"left"},{name:"CATEGORIA",label:"CATEGORIA ",field:"CATEGORIA",sortable:!0,align:"left"},{name:"OWNER_ITEM_ID",label:"OWNERD BY",field:"OWNER_ITEM_ID",sortable:!0,align:"left"},{name:"SUMMARY",label:"SUMMARY",field:"SUMMARY",sortable:!0,align:"left"},{name:"INTERNAL_STATE",label:"STATO",field:"INTERNAL_STATE",sortable:!0,align:"left"},{name:"INTERNAL_SEVERITY",label:"INTERNAL_SEVERITY",field:"INTERNAL_SEVERITY",sortable:!0},{name:"INTERNAL_PRIORITY",label:"INTERNAL_PRIORITY",field:"INTERNAL_PRIORITY",sortable:!0},{name:"CREATION_DATE ",label:"CREATION_DATE",field:"CREATION_DATE",sortable:!0},{name:"MODIFIED",label:"MODIFIED_DATE",field:"COLUMODIFIEDMN_DEFAULT",sortable:!0},{name:"RESOLUTION_DATE",label:"RESOLUTION_DATE",field:"RESOLUTION_DATE",sortable:!0}]}),getters:{getCategories:e=>e.categories.map((e=>({label:e.NAME_COL.trim(),val:e.ITEM_ID}))),getUsernames:e=>e.usernames.map((e=>({label:e.USER_COL.trim()}))),getWis:e=>e.wis},actions:{async loadCategories(){let e="http://"+window.location.hostname+":3300/db2/category";const a=await fetch(e,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),l=await a.json();if(!a.ok)throw 409===l.code?new Error(l.message):new Error("Request failed with error code: "+a.status);this.categories=l},async loadUsernames(){let e="http://"+window.location.hostname+":3300/db2/usernames";const a=await fetch(e,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),l=await a.json();if(!a.ok)throw 409===l.code?new Error(l.message):new Error("Request failed with error code: "+a.status);this.usernames=l},async loadWis(e){let a="http://"+window.location.hostname+":3300/db2/wis/?category="+e.category+"&user="+e.user+"&resolved="+e.resolved;const l=await fetch(a,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await l.json();if(!l.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+l.status);this.wis=o},async loadSingleWi(e){let a="http://"+window.location.hostname+":3300/db2/wi/?id="+e;console.log(a);const l=await fetch(a,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await l.json();if(this.sendLogsAction(e),!l.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+l.status);this.wis=o},async sendLogsAction(e){let a="http://"+window.location.hostname+":3300/db2/log/?log="+s.Z.getItem("currentUser")+" WORK_ITEM: ---\x3e      \n\n"+e;console.log(a);const l=await fetch(a,{method:"GET",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",enctype:"mutipart/form-data"}),o=await l.json();if(!l.ok)throw 409===o.code?new Error(o.message):new Error("Request failed with error code: "+l.status)}}});var c=l(2841),u=l(8825);const m={class:"row q-pa-md"},p={class:"q-mx-lg scritta"},g={__name:"Workitems",setup(e){const a=d(),l=(0,t.iH)(null),i=(0,u.Z)(),s=(e,a)=>{let l=void 0!==a?a(e):e;return l=void 0===l||null===l?"":String(l),l=l.split('"').join('""'),`"${l}"`},g=()=>{var e=[];l.value.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(l.value.filteredSortedRows[0]));var a=[];e.forEach((e=>{a.push({field:e,name:e,label:e})}));const o=[a.map((e=>s(e.label)))].concat(l.value.filteredSortedRows.map((e=>a.map((a=>s("function"===typeof a.field?a.field(e):e[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n");(0,c.Z)("table-export.csv",o,"text/csv")},w=()=>{f(!1)},f=async e=>{try{var l=[];void 0!=a.category.value&&a.category.value.forEach((e=>{l.push(e.val)}));var o=[];void 0!=a.username.value&&a.username.value.forEach((e=>{o.push(e.label)})),e&&0==o.length&&o.push(i.localStorage.getItem("currentUser").toLowerCase().substring(3));const t={category:l,user:o,resolved:a.resolved?"1":""};a.loading=!0,await a.loadWis(t),a.loading=!1}catch(t){console.log(t)}},h=(e,l)=>{l(""!==e?()=>{const l=e.toLowerCase();a.optionsC.value=a.categoryOptions.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{a.optionsC.value=a.categoryOptions.value})},b=async()=>{a.loadingCat=!0,await a.loadCategories(),a.categoryOptions.value=a.getCategories,a.loadingCat=!1},E=()=>{f(!1)},T=(e,l)=>{l(""!==e?()=>{const l=e.toLowerCase();a.optionsU.value=a.usernameOptions.value.filter((e=>e.label.toLowerCase().indexOf(l)>-1))}:()=>{a.optionsU.value=a.usernameOptions.value})},v=async()=>{a.loadingInputFiles=!0,await a.loadUsernames(),a.usernameOptions.value=a.getUsernames,a.loadingInputFiles=!1},I=()=>{f(!1)},S=()=>{null!=a.wiSearch&&""!=a.wiSearch?y():console.log("Not a valid word")},y=async()=>{try{a.loading=!0,console.log(a.wiSearch),await a.loadSingleWi(a.wiSearch),a.loading=!1}catch(e){console.log(e)}};return(0,o.bv)((()=>{b(),v(),f(!0)})),(e,i)=>{const s=(0,o.up)("q-item-label"),d=(0,o.up)("q-item-section"),c=(0,o.up)("q-toggle"),u=(0,o.up)("q-item"),f=(0,o.up)("q-select"),b=(0,o.up)("q-icon"),v=(0,o.up)("q-input"),y=(0,o.up)("q-btn"),U=(0,o.up)("q-card-section"),_=(0,o.up)("q-card"),R=(0,o.up)("q-inner-loading"),W=(0,o.up)("q-table");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(_,{bordered:"",class:"q-my-sm q-mx-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,{class:""},{default:(0,o.w5)((()=>[(0,o._)("div",m,[(0,o.Wm)(f,{dense:"",class:"q-mr-lg",options:(0,t.SU)(a).optionsC.value,modelValue:(0,t.SU)(a).category.value,"onUpdate:modelValue":[i[0]||(i[0]=e=>(0,t.SU)(a).category.value=e),w],onFilter:h,loading:(0,t.SU)(a).loadingCat,"transition-show":"flip-up","transition-hide":"flip-down",disable:(0,t.SU)(a).loadingCat,"use-input":"","input-debounce":"0",label:"(AREA) Filed Against",clearable:"",multiple:"","emit-value":"","map-options":""},{option:(0,o.w5)((({itemProps:e,opt:a,selected:l,toggleOption:t})=>[(0,o.Wm)(u,(0,r.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{innerHTML:a.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(d,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{"model-value":l,"onUpdate:modelValue":e=>t(a)},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:2},1040)])),"no-option":(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"text-grey"},{default:(0,o.w5)((()=>[(0,o.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["options","modelValue","loading","disable"]),(0,o.Wm)(f,{class:"q-ml-md",options:(0,t.SU)(a).optionsU.value,modelValue:(0,t.SU)(a).username.value,"onUpdate:modelValue":[i[1]||(i[1]=e=>(0,t.SU)(a).username.value=e),E],onFilter:T,dense:"","use-input":"",loading:(0,t.SU)(a).loadingInputFiles,"transition-show":"flip-up","transition-hide":"flip-down",disable:(0,t.SU)(a).loadingInputFiles,"input-debounce":"0",label:"Owned By",autofocus:"",clearable:"",multiple:"","emit-value":"","map-options":""},{option:(0,o.w5)((({itemProps:e,opt:a,selected:l,toggleOption:t})=>[(0,o.Wm)(u,(0,r.vs)((0,o.F4)(e)),{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o.Wm)(s,{innerHTML:a.label},null,8,["innerHTML"])])),_:2},1024),(0,o.Wm)(d,{side:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{"model-value":l,"onUpdate:modelValue":e=>t(a)},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:2},1040)])),"no-option":(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{class:"text-grey"},{default:(0,o.w5)((()=>[(0,o.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["options","modelValue","loading","disable"]),(0,o._)("div",p,[(0,o.Wm)(c,{dense:"",modelValue:(0,t.SU)(a).resolved,"onUpdate:modelValue":[i[2]||(i[2]=e=>(0,t.SU)(a).resolved=e),I],size:"xl",icon:"visibility",label:"Opened",color:"purple"},null,8,["modelValue"])]),(0,o.Wm)(v,{class:"q-mr-sm",dense:"",square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:(0,t.SU)(a).wiSearch,"onUpdate:modelValue":i[3]||(i[3]=e=>(0,t.SU)(a).wiSearch=e),label:"Search one or a list of WI",onKeyup:(0,n.D2)(S,["enter"])},{append:(0,o.w5)((()=>[(0,o.Wm)(b,{name:"bolt",color:"primary"})])),_:1},8,["modelValue","onKeyup"]),(0,o.Wm)(y,{dense:"",inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:S,disable:null==(0,t.SU)(a).wiSearch||""==(0,t.SU)(a).wiSearch},null,8,["disable"])])])),_:1})])),_:1}),(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[(0,o.Wm)(W,{class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white ",rows:(0,t.SU)(a).getWis,columns:(0,t.SU)(a).columns,"row-key":"wiStore.getWis.ID",dense:"","auto-width":"",grid:(0,t.SU)(a).grid,loading:(0,t.SU)(a).loading,boarderd:"",title:"Risultato Workitems",separator:"cell",style:{height:"720px"},filter:(0,t.SU)(a).filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18],ref_key:"tabCol",ref:l},{"top-right":(0,o.w5)((()=>[(0,o.Wm)(v,{borderless:"",dense:"",debounce:"300",modelValue:(0,t.SU)(a).filter,"onUpdate:modelValue":i[5]||(i[5]=e=>(0,t.SU)(a).filter=e),placeholder:"Search"},{append:(0,o.w5)((()=>[(0,o.Wm)(b,{name:"search",color:"white"}),(0,o.Wm)(c,{modelValue:(0,t.SU)(a).grid,"onUpdate:modelValue":i[4]||(i[4]=e=>(0,t.SU)(a).grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,o.Wm)(y,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:g})])),loading:(0,o.w5)((()=>[(0,o.Wm)(R,{showing:"",color:"primary"})])),_:1},8,["rows","columns","grid","loading","filter"])])),_:1})])),_:1})])}}};var w=l(151),f=l(5589),h=l(3017),b=l(3414),E=l(2035),T=l(2350),v=l(8886),I=l(4842),S=l(4554),y=l(8240),U=l(6429),_=l(6941),R=l(6115),W=l(7518),O=l.n(W);const C=g,A=C;O()(g,"components",{QCard:w.Z,QCardSection:f.Z,QSelect:h.Z,QItem:b.Z,QItemSection:E.Z,QItemLabel:T.Z,QToggle:v.Z,QInput:I.Z,QIcon:S.Z,QBtn:y.Z,QTable:U.Z,QInnerLoading:_.Z,QField:R.Z})}}]);