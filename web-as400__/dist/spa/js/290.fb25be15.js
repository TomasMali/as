"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[290],{3290:(e,l,a)=>{a.r(l),a.d(l,{default:()=>x});var t=a(4852);const i={class:""},o={class:"row q-mb-md"},s={key:0,class:"col q-mr-md",style:{"border-style":"ridge"}},r={class:"col flex q-pa-md",style:{"border-style":"ridge"}},n={class:"row q-pa-md",style:{"border-style":"ridge"}},d={class:"q-ml-lg scritta"};function c(e,l,a,c,m,h){const u=(0,t.up)("q-option-group"),g=(0,t.up)("q-icon"),f=(0,t.up)("q-input"),p=(0,t.up)("q-btn"),b=(0,t.up)("q-checkbox"),E=(0,t.up)("q-item-section"),y=(0,t.up)("q-item"),A=(0,t.up)("q-select"),w=(0,t.up)("q-toggle"),T=(0,t.up)("q-card-section"),L=(0,t.up)("q-card"),N=(0,t.up)("q-inner-loading"),S=(0,t.up)("q-table");return(0,t.wg)(),(0,t.iD)("div",i,[(0,t.Wm)(L,{bordered:"",class:"q-my-sm q-mx-md"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{class:""},{default:(0,t.w5)((()=>[(0,t._)("div",o,[m.pref.getUserPrefAsObj.length>0?((0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(u,{class:"q-mt-md",modelValue:m.group,"onUpdate:modelValue":[l[0]||(l[0]=e=>m.group=e),h.onGroupChange],options:m.pref.getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","onUpdate:modelValue","options"])])):(0,t.kq)("",!0),(0,t._)("div",r,[(0,t.Wm)(f,{dense:"",style:{width:"170px"},square:"",color:"primary","label-color":"primary",outlined:"",clearable:"",modelValue:m.fastWordSearch,"onUpdate:modelValue":l[1]||(l[1]=e=>m.fastWordSearch=e),label:"Fast Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(g,{name:"bolt",color:"primary"})])),_:1},8,["modelValue"]),(0,t.Wm)(p,{dense:"",loading:m.loading,inline:"",color:"primary q-ml-sm",label:"Search","icon-right":"send",onClick:h.fastSearch,disable:null==m.fastWordSearch||""==m.fastWordSearch||m.fastWordSearch.length<3},null,8,["loading","onClick","disable"]),(0,t.Wm)(b,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:m.searchFile,"onUpdate:modelValue":l[2]||(l[2]=e=>m.searchFile=e),label:"Cerca File"},null,8,["modelValue"]),(0,t.Wm)(b,{dense:"",class:"q-ml-xl",size:"lg","left-label":"",modelValue:m.deep,"onUpdate:modelValue":l[3]||(l[3]=e=>m.deep=e),label:"Ricerca profonda"},null,8,["modelValue"])])]),(0,t._)("div",n,[(0,t.Wm)(A,{dense:"",filled:"",modelValue:m.libDatModel,"onUpdate:modelValue":[l[4]||(l[4]=e=>m.libDatModel=e),h.onClickLibdat],"use-input":"","input-debounce":"0",label:"LIBDAT",clearable:"",options:m.options,onFilter:h.filterFn,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(y,null,{default:(0,t.w5)((()=>[(0,t.Wm)(E,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","options","onFilter","onUpdate:modelValue"]),(0,t.Wm)(A,{class:"q-ml-md",style:{"max-height":"500px"},dense:"",filled:"",modelValue:m.fileNameModel,"onUpdate:modelValue":[l[5]||(l[5]=e=>m.fileNameModel=e),h.onClickFilename],"use-input":"",loading:m.loadingInputFiles,disable:m.loadingInputFiles,"input-debounce":"0",label:"FILE",autofocus:"",clearable:"",options:m.fileNamesOptions,onFilter:h.filterFileNames,behavior:"menu"},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(y,null,{default:(0,t.w5)((()=>[(0,t.Wm)(E,{class:"text-grey"},{default:(0,t.w5)((()=>[(0,t.Uk)("No results")])),_:1})])),_:1})])),_:1},8,["modelValue","loading","disable","options","onFilter","onUpdate:modelValue"]),(0,t._)("div",d,[(0,t.Wm)(w,{dense:"",modelValue:m.queryToggle,"onUpdate:modelValue":l[6]||(l[6]=e=>m.queryToggle=e),size:"xl",icon:"visibility",label:"Show 500",color:"red"},null,8,["modelValue"])])])])),_:1})])),_:1}),m.queryToggle||m.queryStr.launchQueryPrefered?m.queryToggle&&!m.queryStr.launchQueryPrefered?((0,t.wg)(),(0,t.j4)(S,{key:1,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white ",rows:m.queries,"row-key":"index",dense:"","auto-width":"",grid:m.grid,loading:m.loading,boarderd:"",title:m.fileNameModel,separator:"cell",style:{height:"640px"},filter:m.filter,rowsPerPage:1e4,"rows-per-page-options":[0,8,18],ref:"tabCol"},{"top-right":(0,t.w5)((()=>[(0,t.Wm)(f,{borderless:"",dense:"",debounce:"300",modelValue:m.filter,"onUpdate:modelValue":l[10]||(l[10]=e=>m.filter=e),placeholder:"Search"},{append:(0,t.w5)((()=>[(0,t.Wm)(g,{name:"search",color:"white"}),(0,t.Wm)(w,{modelValue:m.grid,"onUpdate:modelValue":l[9]||(l[9]=e=>m.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(p,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:h.exportTableField},null,8,["onClick"])])),_:1},8,["rows","grid","loading","title","filter"])):m.queryStr.queries.length?((0,t.wg)(),(0,t.j4)(S,{key:2,loading:m.queryStr.loadingTable,class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:m.queryStr.queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:m.queryStr.filter,grid:m.queryStr.grid,ref:"queryTab"},{loading:(0,t.w5)((()=>[(0,t.Wm)(N,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(f,{borderless:"",dense:"",debounce:"300",modelValue:m.queryStr.filter,"onUpdate:modelValue":l[12]||(l[12]=e=>m.queryStr.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(g,{name:"search",color:"white"}),(0,t.Wm)(w,{color:"red",modelValue:m.queryStr.grid,"onUpdate:modelValue":l[11]||(l[11]=e=>m.queryStr.grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(p,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:h.exportTableQuery},null,8,["onClick"])])),_:1},8,["loading","rows","filter","grid"])):(0,t.kq)("",!0):((0,t.wg)(),(0,t.j4)(S,{key:0,loading:m.loadingTable,dense:"","auto-width":"",class:"text-subtitle2 my-sticky-header-table","table-header-class":"text-white",grid:m.grid,rows:m.rows,columns:m.columns,"row-key":"name",boarderd:"",title:m.fileNameModel,separator:"cell",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"640px"},filter:m.filter,ref:"tb"},{loading:(0,t.w5)((()=>[(0,t.Wm)(N,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(g,{name:"search",size:"sm",class:"q-mr-sm",color:"white"}),(0,t.Wm)(f,{class:"",borderless:"",dense:"",modelValue:m.filter,"onUpdate:modelValue":l[8]||(l[8]=e=>m.filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:m.grid,"onUpdate:modelValue":l[7]||(l[7]=e=>m.grid=e),color:"red",label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"]),(0,t.Wm)(p,{flat:"",class:"q-ml-xl",color:"yellow","icon-right":"archive",label:"Export to csv","no-caps":"",onClick:h.exportTable},null,8,["onClick"])])),_:1},8,["loading","grid","rows","columns","title","filter"])),(h.libDatModelComputed,(0,t.kq)("",!0))])}a(5663),a(3610);var m=a(4323),h=a(2841),u=a(8825),g=a(6041),f=a(1390),p=a(5214),b=a(9889),E=a(1965);const y={data(){return{q:(0,u.Z)(),as:null,pref:null,queryStr:null,voice:null,fastWordSearch:"",deep:!1,searchFile:!1,queries:[],queryToggle:!1,launchQueryPrefered:!1,pagination:{rowsPerPage:0},group:(0,m.iH)(""),loadingInputFiles:!1,libDatModel:null,stringOptions:[],options:this.stringOptions,fileNameModel:null,filenamesArray:[],fileNamesOptions:this.filenamesArray,separator:"vertical",filter:"",grid:!1,loading:!1,loadingTable:!1,fileName:"ROLE_USER",lib:"WRKJEXP",rows:[],columns:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}],selectedFileName:{},blockLocalStorage:!1}},computed:{libDatModelComputed(){return null==this.queryStr.getSelectedFileName||this.blockLocalStorage?(this.blockLocalStorage=!1,"original"):this.onClickFilenameForced()}},methods:{voiceChanged(){},exportTable(){const e=[this.columns.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tb.filteredSortedRows.map((e=>this.columns.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,h.Z)("table-export.csv",e,"text/csv")},exportTableField(){var e=[];this.$refs.tabCol.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(this.$refs.tabCol.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const a=[l.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.tabCol.filteredSortedRows.map((e=>l.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,h.Z)("table-export.csv",a,"text/csv")},exportTableQuery(){var e=[];this.$refs.queryTab.filteredSortedRows.length>0&&(e=Object.getOwnPropertyNames(this.$refs.queryTab.filteredSortedRows[0]));var l=[];e.forEach((e=>{l.push({field:e,name:e,label:e})}));const a=[l.map((e=>this.wrapCsvValue(e.label)))].concat(this.$refs.queryTab.filteredSortedRows.map((e=>l.map((l=>this.wrapCsvValue("function"===typeof l.field?l.field(e):e[void 0===l.field?l.name:l.field],l.format))).join(",")))).join("\r\n");(0,h.Z)("table-export.csv",a,"text/csv")},wrapCsvValue(e,l){let a=void 0!==l?l(e):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`},async loadFilenames(){try{const e={filename:this.libDatModel};this.loadingInputFiles=!0,await this.as.getFilenamesAction(e),this.filenamesArray=[],this.as.getFilenames.forEach((e=>{this.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),this.loadingInputFiles=!1}catch(e){console.log(e)}},async loadLibdat(){try{const e={user:""};await this.pref.setUserPref(this.q.localStorage.getItem("currentUser")),await this.pref.getUserPrefAsObj.length>0&&(this.group=this.pref.getUserPrefAsObj[0].value,this.libDatModel=this.group),await this.as.getUsersAction(e),await this.as.getUsers.forEach((e=>{this.stringOptions.push(e.TABLE_SCHEMA)})),this.loadFilenames()}catch(e){console.log(e)}},async loadFiles(){if(null!=this.fileNameModel){this.loadingTable=!0,this.rows=[];try{var e={lib:this.libDatModel,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(l){console.log(l),this.loadingTable=!1}}},async loadFilesForced(){this.loadingTable=!0,this.rows=[];try{const e={lib:this.queryStr.getSelectedFileName.libname,fileName:this.queryStr.getSelectedFileName.filename};this.libDatModel=this.queryStr.getSelectedFileName.libname,this.fileNameModel=this.queryStr.getSelectedFileName.filenameOriginal,this.loadFilenames(),await this.as.getFilesAction(e),this.rows=this.as.getFiles,this.loadingTable=!1}catch(e){console.log(e),this.loadingTable=!1}},async loadQueries(){if(this.fileNameModel){this.loading=!0,this.queries=[];try{const e={lib:this.libDatModel,fileName:this.fileNameModel.split("--\x3e")[0].trim()};await this.as.getQueriesAction(e),this.queries=this.as.getQueries,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},async loadFastFiles(){if(""!==this.fastWordSearch){this.loading=!0,this.rows=[];try{const e={user:null!=this.q.localStorage.getItem("currentUser")&&""!=this.q.localStorage.getItem("currentUser")?this.q.localStorage.getItem("currentUser").trim():"",search_word:this.fastWordSearch.trim(),all:this.deep?"all":"no",searchFile:this.searchFile?"true":"false"};await this.as.getFastFilesAction(e),this.rows=this.as.getFastFiles,this.loading=!1}catch(e){console.log(e),this.loading=!1}}},onClickLibdat(e){this.loadFilenames(),this.fileNameModel=null},onClickFilename(e){this.loadFiles(),this.updateLocalStorageForFastResearch(),this.filter="",this.queryStr.launchQueryPrefered=!1},onClickFilenameForced(e){return this.loadFilesForced(),this.filter="",this.queryStr.launchQueryPrefered=!1,"local"},filterFileNames(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.fileNamesOptions=this.filenamesArray.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.fileNamesOptions=this.filenamesArray})},filterFn(e,l){l(""!==e?()=>{const l=e.toLowerCase();this.options=this.stringOptions.filter((e=>e.toLowerCase().indexOf(l)>-1))}:()=>{this.options=this.stringOptions})},fastSearch(){this.loadFastFiles()},onGroupChange(){this.blockLocalStorage=!0,this.libDatModel=this.group,this.loadFilenames(),this.fileNameModel=null},updateLocalStorageForFastResearch(){if(null!=this.libDatModel&&null!=this.fileNameModel){var e=this.libDatModel.trim()+"."+this.fileNameModel.trim(),l=[];null==this.q.localStorage.getItem("fileNameList")?(l.push(e),this.q.localStorage.set("fileNameList",l)):(l=this.q.localStorage.getItem("fileNameList"),l.includes(e)||(l.length>9?(l.shift(),l.push(e),this.q.localStorage.set("fileNameList",l)):(l.push(e),this.q.localStorage.set("fileNameList",l)))),this.queryStr.setFileNameListLocalStorage()}}},watch:{queryToggle(e,l){e&&(this.loadQueries(),this.queryStr.launchQueryPrefered=!1)},fileNameModel(e,l){""!==e&&null!=this.fileNameModel&&this.queryToggle&&this.loadQueries()},fastWordSearch(e,l){},searchFile(e,l){this.columns=e?[{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"TABLE_TEXT",label:"TABLE_TEXT",field:"TABLE_TEXT",sortable:!0,align:"center"},{name:"TABLE_DEFINER",label:"TABLE_DEFINER",field:"TABLE_DEFINER",sortable:!0,align:"center"}]:[{name:"COLUMN_NAME",label:"CAMPO",field:"COLUMN_NAME",sortable:!0,align:"center"},{name:"COLUMN_TEXT",label:"DESCRIZIONE",field:"COLUMN_TEXT",sortable:!0,align:"left"},{name:"TABLE_SCHEMA",label:"LIBRERIA",field:"TABLE_SCHEMA",sortable:!0,align:"left"},{name:"TABLE_NAME",label:"FILE",field:"TABLE_NAME",sortable:!0,align:"left"},{name:"KEY_COLUMN",label:"CHIAVE",field:"KEY_COLUMN",sortable:!0,align:"left"},{name:"KEY_ORDER",label:"KEY_ORDER",field:"KEY_ORDER",sortable:!0,align:"left"},{name:"DATA_TYPE",label:"TIPO",field:"DATA_TYPE",sortable:!0},{name:"LENGTH",label:"LUNGHEZZA",field:"LENGTH",sortable:!0},{name:"NUMERIC_SCALE ",label:"DECIMALE",field:"NUMERIC_SCALE",sortable:!0},{name:"COLUMN_DEFAULT",label:"DEFAULT",field:"COLUMN_DEFAULT",sortable:!0},{name:"CHARACTER_MAXIMUM_LENGTH",label:"LUNGEZZA MASSIMA",field:"CHARACTER_MAXIMUM_LENGTH",sortable:!0}]}},created(){this.as=(0,f.o)(),this.pref=(0,p.H)(),this.queryStr=(0,g.U)(),this.loadLibdat(),this.voice=(0,b._)(),this.selectedFileName=this.queryStr.getSelectedFileName},components:{Voice:E.Z}};var A=a(4260),w=a(151),T=a(5589),L=a(8758),N=a(4842),S=a(4554),C=a(8240),M=a(5735),q=a(3017),_=a(3414),F=a(2035),U=a(8886),V=a(8107),I=a(6941),O=a(7518),R=a.n(O);const v=(0,A.Z)(y,[["render",c]]),x=v;R()(y,"components",{QCard:w.Z,QCardSection:T.Z,QOptionGroup:L.Z,QInput:N.Z,QIcon:S.Z,QBtn:C.Z,QCheckbox:M.Z,QSelect:q.Z,QItem:_.Z,QItemSection:F.Z,QToggle:U.Z,QTable:V.Z,QInnerLoading:I.Z})}}]);