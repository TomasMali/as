"use strict";(globalThis["webpackChunkweb_as400"]=globalThis["webpackChunkweb_as400"]||[]).push([[174],{7174:(e,l,o)=>{o.r(l),o.d(l,{default:()=>pe});var t=o(3673),a=o(1959),i=o(2323),r=o(8880),s=o(8825),d=o(6041),n=o(5214);const u={class:"q-px-xl"},c=(0,t.Uk)(" Crea "),m={key:0,class:"flex flex-center"},p=(0,t.Uk)("Caricando le query...."),w={key:0,class:"flex flex-center text-red"},g=(0,t.Uk)("   "),f=(0,t.Uk)("\n   "),y=(0,t._)("div",{class:"text-h6 text-primary"},"Composizione query",-1),U={style:{"max-height":"80vh"},class:"my-modify-placeholder scroll"},b={class:"row q-col-gutter-x-md"},_={class:"col"},S={key:0,class:"col"},h={class:"col"},q={class:"row"},W={class:"col"},k={class:"row"},x={class:"row"},v={class:"q-pa-md row items-start q-gutter-md"},V={class:"text-subtitle2 text-red q-mt-lg"},Q=(0,t.Uk)("No results"),C=(0,t.Uk)("No results"),L={class:"vertical"},T={class:"text-subtitle2 text-red q-ma-none"},A={class:"row q-mt-md q-px-lg"},E={class:"col q-pa-lg",style:{height:"150px"}},M={class:"col"},Z={class:""},O={__name:"Query",setup(e){const l=(0,d.U)(),o=(0,s.Z)(),O=(0,n.H)(),N=(0,a.iH)(""),D=e=>{l.setPreview()},H=(e,o)=>{l.setPreview()},F=async e=>{l.loadingTable=!0,await l.excecQuery(e),l.loadingTable=!1},z=async()=>{l.loaderUserQuery=!0,await l.selectUserQuery(o.localStorage.getItem("currentUser")),l.loaderUserQuery=!1,N.value=O.getUserPrefAsObj[0].value,l.libdatM=N.value,G()},I=()=>{l.libdatM=N.value,G(),l.fileM=(0,a.iH)(null),l.selected=(0,a.iH)([]),l.rows=[]},P=e=>{l.rows=[],l.selected=(0,a.iH)([]),l.sqlAutomati(),l.toggleWhere&&R()},R=async()=>{if(l.fileM&&l.libdatM){l.columsLoading=!0,l.rows=[];try{const e={lib:l.libdatM,fileName:l.fileM.split("--\x3e")[0].trim()};await l.getColumsAction(e),l.columsLoading=!1}catch(e){console.log(e),l.columsLoading=!1}}},j=()=>{l.sqlAutomati(),P({}),l.selected=(0,a.iH)([])},B=()=>{l.selected=(0,a.iH)([]),l.rows=[],l.toggleWhere=!1,l.fileM=(0,a.iH)(null)},X=()=>{l.insertUserQuery({user:o.localStorage.getItem("currentUser"),title:l.title,sqlstr:l.sqlQuery,note:l.note}),o.notify({color:"primary",textColor:"white",icon:"insert",message:"Query inserita con successo",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),l.user=(0,a.iH)(""),l.title=(0,a.iH)(""),l.sqlQuery=(0,a.iH)(""),l.note=(0,a.iH)("")},Y=(e,t)=>{o.dialog({dark:!0,title:"Confirm",message:"Vuoi cancellare la tua query?",cancel:!0,persistent:!0}).onOk((()=>{o.notify({color:"primary",textColor:"white",icon:"delete",message:"Query cancellata con successo",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),l.deleteUserQuery(e,t)})).onCancel((()=>{})).onDismiss((()=>{}))},K=(e,t,a)=>{a="S"==a?"N":"S",o.dialog({dark:!0,title:"Confirm",message:"S"==a?"Vuoi applicare questa query come preferita ?":"Vuoi rimuovere questa query dai preferiti ?",cancel:!0,persistent:!0}).onOk((()=>{o.notify({color:"primary",textColor:"white",icon:"delete",message:"Query modificata con successo",actions:[{label:"Dismiss",color:"white",handler:()=>{}}]}),l.modifyQyeryPref(e,t,a)})).onCancel((()=>{})).onDismiss((()=>{}))},G=()=>{J(),l.sqlAutomati()},J=async()=>{try{const e={filename:l.libdatM};l.loadingFileM=!0,await l.getFilenamesAction(e),l.filenamesArray=[],l.getFilenames.forEach((e=>{l.filenamesArray.push(e.TABLE_NAME+" --\x3e "+e.TABLE_TEXT)})),l.loadingFileM=!1}catch(e){console.log(e)}},$=e=>{l.user=e.LIBDAT,l.title=e.TITLE,l.sqlQuery=e.SQLSTR,l.note=e.NOTE,l.dialog=!0,l.createDialog=!1},ee=(e,o)=>{o(""!==e?()=>{const o=e.toLowerCase();l.optionLibdat=l.stringOptLibdat.filter((e=>e.toLowerCase().indexOf(o)>-1))}:()=>{l.optionLibdat=l.stringOptLibdat})},le=(e,o)=>{o(""!==e?()=>{const o=e.toLowerCase();l.optionFile=l.filenamesArray.filter((e=>e.toLowerCase().indexOf(o)>-1))}:()=>{l.optionFile=l.filenamesArray})},oe=async()=>{l.sqlQuery=(0,a.iH)(""),l.title=(0,a.iH)(""),l.note=(0,a.iH)("");try{const e={user:""};await l.getLibdatAction(e),l.getLibl.forEach((e=>{l.stringOptLibdat.push(e.TABLE_SCHEMA)}))}catch(e){console.log(e)}},te=e=>{F(e)},ae=()=>{l.cleanDialog(),z(),oe(),l.dialog=!0,l.createDialog=!0};return(0,t.bv)((()=>{z()})),(e,o)=>{const s=(0,t.up)("q-btn"),d=(0,t.up)("q-card-section"),n=(0,t.up)("q-separator"),F=(0,t.up)("q-spinner-ios"),z=(0,t.up)("q-tooltip"),R=(0,t.up)("q-avatar"),J=(0,t.up)("q-item-section"),oe=(0,t.up)("q-item"),ie=(0,t.up)("q-item-label"),re=(0,t.up)("q-list"),se=(0,t.up)("q-card"),de=(0,t.up)("q-inner-loading"),ne=(0,t.up)("q-icon"),ue=(0,t.up)("q-toggle"),ce=(0,t.up)("q-input"),me=(0,t.up)("q-table"),pe=(0,t.up)("q-option-group"),we=(0,t.up)("q-select"),ge=(0,t.up)("q-checkbox"),fe=(0,t.up)("q-td"),ye=(0,t.up)("q-popup-edit"),Ue=(0,t.up)("q-tr"),be=(0,t.up)("q-card-actions"),_e=(0,t.up)("q-dialog"),Se=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("div",u,[(0,t.Wm)(se,{class:"my-card"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t.Wm)(s,{color:"primary","text-color":"white",lable:"Crea",onClick:ae},{default:(0,t.w5)((()=>[c])),_:1})])),_:1}),(0,t.Wm)(n,{inset:""}),(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,a.SU)(l).loaderUserQuery?((0,t.wg)(),(0,t.iD)("div",m,[(0,t.Wm)(F,{color:"primary",size:"7em"}),(0,t.Wm)(z,{offset:[0,8]},{default:(0,t.w5)((()=>[p])),_:1})])):((0,t.wg)(),(0,t.j4)(re,{key:1,bordered:"",separator:"",class:"text-primary text-subtitle2",style:{"max-height":"400px",overflow:"auto"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)((0,a.SU)(l).queriesSaved,(e=>((0,t.wg)(),(0,t.j4)(oe,{dense:"",clickable:"",key:e.SQLSTR},{default:(0,t.w5)((()=>[(0,t.Wm)(oe,{dense:"",clickable:"",class:"q-mr-sm"},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{onClick:l=>te(e.SQLSTR),color:"primary","text-color":"white",icon:"play_arrow"},null,8,["onClick"])])),_:2},1024)])),_:2},1024),(0,t.Wm)(oe,{dense:"",clickable:"",class:"q-mr-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{onClick:l=>Y(e.LIBDAT,e.TITLE),rounded:"",flat:"",icon:"delete"},null,8,["onClick"])])),_:2},1024)])),_:2},1024),(0,t.Wm)(J,{style:{"max-width":"150px"},onClick:l=>$(e)},{default:(0,t.w5)((()=>[(0,t.Wm)(ie,null,{default:(0,t.w5)((()=>[(0,t._)("b",null,(0,i.zw)(e.TITLE),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,t.Wm)(J,{class:"text-left",onClick:l=>$(e)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.SQLSTR),1)])),_:2},1032,["onClick"]),(0,t.Wm)(J,{class:"text-left",onClick:l=>$(e)},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.NOTE),1)])),_:2},1032,["onClick"]),(0,t.Wm)(oe,{dense:"",clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(J,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(R,{onClick:l=>K(e.LIBDAT,e.TITLE,e.PREF),rounded:"",flat:"","text-color":"S"==e.PREF?"red":"grey",icon:"favorite"},null,8,["onClick","text-color"])])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}))])),_:1})])),_:1})]),null!==(0,a.SU)(l).gError?((0,t.wg)(),(0,t.iD)("pre",w,[g,(0,t._)("b",null," errore:  "+(0,i.zw)((0,a.SU)(l).gError)+" ",1),f])):(0,a.SU)(l).queries.length?((0,t.wg)(),(0,t.j4)(me,{key:1,loading:(0,a.SU)(l).loadingTable,class:"q-mx-xl q-my-lg text-subtitle2 my-sticky-header-table","table-header-class":"text-white",title:"Risultati query",dense:"",boarderd:"","auto-width":"",separator:"cell",rows:(0,a.SU)(l).queries,"row-key":"name",rowsPerPage:30,"rows-per-page-options":[0,8,18],style:{height:"480px"},filter:(0,a.SU)(l).filter,grid:(0,a.SU)(l).grid},{loading:(0,t.w5)((()=>[(0,t.Wm)(de,{showing:"",color:"primary"})])),"top-right":(0,t.w5)((()=>[(0,t.Wm)(ce,{borderless:"",dense:"",debounce:"300",modelValue:(0,a.SU)(l).filter,"onUpdate:modelValue":o[1]||(o[1]=e=>(0,a.SU)(l).filter=e),placeholder:"Search word"},{append:(0,t.w5)((()=>[(0,t.Wm)(ne,{name:"search",color:"white"}),(0,t.Wm)(ue,{color:"red",modelValue:(0,a.SU)(l).grid,"onUpdate:modelValue":o[0]||(o[0]=e=>(0,a.SU)(l).grid=e),label:"Grid"},null,8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["loading","rows","filter","grid"])):(0,t.kq)("",!0),(0,t.Wm)(_e,{modelValue:(0,a.SU)(l).dialog,"onUpdate:modelValue":o[11]||(o[11]=e=>(0,a.SU)(l).dialog=e),"transition-show":"rotate","transition-hide":"rotate"},{default:(0,t.w5)((()=>[(0,t.Wm)(se,{style:{width:"1800px","max-width":"90vw","max-height":"95%"}},{default:(0,t.w5)((()=>[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[y])),_:1}),(0,t.Wm)(n),(0,t._)("div",U,[(0,t.Wm)(se,{class:"q-ma-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t._)("div",b,[(0,t._)("div",_,[(0,t.Wm)(ce,{filled:"",modelValue:(0,a.SU)(l).title,"onUpdate:modelValue":o[2]||(o[2]=e=>(0,a.SU)(l).title=e),label:"Titolo"},null,8,["modelValue"])]),(0,a.SU)(l).createDialog?(0,t.kq)("",!0):((0,t.wg)(),(0,t.iD)("div",S,[(0,t.Wm)(ce,{outlined:"",style:{"font-family":"Florence","font-size":"20px"},modelValue:(0,a.SU)(l).sqlQuery,"onUpdate:modelValue":o[3]||(o[3]=e=>(0,a.SU)(l).sqlQuery=e),autogrow:"",label:"Scrivi la SQL qui"},null,8,["modelValue"])])),(0,t._)("div",h,[(0,t.Wm)(ce,{modelValue:(0,a.SU)(l).note,"onUpdate:modelValue":o[4]||(o[4]=e=>(0,a.SU)(l).note=e),filled:"",autogrow:"",label:"Note"},null,8,["modelValue"])])])])),_:1})])),_:1}),(0,t.Wm)(se,{class:"q-ma-lg"},{default:(0,t.w5)((()=>[(0,a.SU)(l).createDialog?((0,t.wg)(),(0,t.j4)(d,{key:0,bordered:"",class:"my-card"},{default:(0,t.w5)((()=>[(0,t._)("div",q,[(0,t._)("div",W,[(0,t._)("div",k,[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t._)("div",x,[(0,t.Wm)(pe,{modelValue:N.value,"onUpdate:modelValue":[o[5]||(o[5]=e=>N.value=e),I],options:(0,a.SU)(O).getUserPrefAsObj,color:"primary",inline:""},null,8,["modelValue","options"])]),(0,t._)("div",v,[(0,t._)("p",V,[(0,t._)("b",null,(0,i.zw)((0,a.SU)(l).select),1)]),(0,t.Wm)(we,{filled:"",modelValue:(0,a.SU)(l).libdatM,"onUpdate:modelValue":[o[6]||(o[6]=e=>(0,a.SU)(l).libdatM=e),G],"use-input":"","input-debounce":"0",label:"Libreria dati",clearable:"",options:(0,a.SU)(l).optionLibdat,onFilter:ee,onClear:B,behavior:"menu",style:{"max-width":"180px",height:"15px important!"}},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(oe,null,{default:(0,t.w5)((()=>[(0,t.Wm)(J,{class:"text-grey"},{default:(0,t.w5)((()=>[Q])),_:1})])),_:1})])),_:1},8,["modelValue","options"]),(0,t.Wm)(we,{filled:"","hide-bottom-space":"",loading:(0,a.SU)(l).loadingFileM,modelValue:(0,a.SU)(l).fileM,"onUpdate:modelValue":[o[7]||(o[7]=e=>(0,a.SU)(l).fileM=e),j],"use-input":"","input-debounce":"0",label:"File",clearable:"",options:(0,a.SU)(l).optionFile,onFilter:le,onClear:B,behavior:"menu",style:{"max-width":"280px",height:"15px important!"}},{"no-option":(0,t.w5)((()=>[(0,t.Wm)(oe,null,{default:(0,t.w5)((()=>[(0,t.Wm)(J,{class:"text-grey"},{default:(0,t.w5)((()=>[C])),_:1})])),_:1})])),_:1},8,["loading","modelValue","options"]),(0,t._)("div",L,[(0,t._)("p",T,(0,i.zw)((0,a.SU)(l).where),1),(0,t.Wm)(ue,{disable:!(0,a.SU)(l).fileM,modelValue:(0,a.SU)(l).toggleWhere,"onUpdate:modelValue":[o[8]||(o[8]=e=>(0,a.SU)(l).toggleWhere=e),P],color:"primary"},null,8,["disable","modelValue"])])])])),_:1})]),(0,t._)("div",A,[(0,t._)("div",E,[(0,t.Wm)(ce,{outlined:"",style:{"font-family":"Florence","font-size":"20px"},modelValue:(0,a.SU)(l).sqlQuery,"onUpdate:modelValue":o[9]||(o[9]=e=>(0,a.SU)(l).sqlQuery=e),autogrow:"",label:"Scrivi la SQL qui"},null,8,["modelValue"])])])]),(0,t._)("div",M,[(0,t.Wm)(d,null,{default:(0,t.w5)((()=>[(0,t._)("div",Z,[(0,t.wy)((0,t.Wm)(me,{dense:"",title:"Seleziona campi",rows:(0,a.SU)(l).rows,columns:(0,a.SU)(l).columns,"row-key":"COLUMN_TEXT",selection:"multiple",boarderd:"",rowsPerPage:30,"rows-per-page-options":[0,2,18],style:{height:"500px"},selected:(0,a.SU)(l).selected,"onUpdate:selected":[o[10]||(o[10]=e=>(0,a.SU)(l).selected=e),D]},{body:(0,t.w5)((e=>[(0,t.Wm)(Ue,{props:e},{default:(0,t.w5)((()=>[(0,t.Wm)(fe,{key:"COLUMN_NAME",props:e,class:"q-mr-lg"},{default:(0,t.w5)((()=>[(0,t.Wm)(ge,{dense:"",modelValue:e.selected,"onUpdate:modelValue":l=>e.selected=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props"]),(0,t.Wm)(fe,{key:"COLUMN_NAME",props:e,class:"q-ml-lg",style:(0,i.j5)([e.selected?"background-color: #ddd; font-size: 16px;":"pointer-events:none"])},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.VALORE)+" ",1),(0,t.Wm)(ye,{onBeforeHide:H,modelValue:e.row.VALORE,"onUpdate:modelValue":l=>e.row.VALORE=l,title:"Scrivi qui il valore",buttons:""},{default:(0,t.w5)((l=>["CHAR"===e.row.DATA_TYPE?((0,t.wg)(),(0,t.j4)(ce,{key:0,type:"text",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,dense:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue"])):((0,t.wg)(),(0,t.j4)(ce,{key:1,type:"number",modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,dense:"",autofocus:""},null,8,["modelValue","onUpdate:modelValue"]))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["props","style"]),(0,t.Wm)(fe,{key:"COLUMN_NAME",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.COLUMN_NAME),1)])),_:2},1032,["props"]),(0,t.Wm)(fe,{key:"COLUMN_TEXT",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.COLUMN_TEXT),1)])),_:2},1032,["props"]),(0,t.Wm)(fe,{key:"KEY_COLUMN",props:e},{default:(0,t.w5)((()=>[(0,t.Uk)((0,i.zw)(e.row.KEY_COLUMN),1)])),_:2},1032,["props"])])),_:2},1032,["props"])])),_:1},8,["rows","columns","selected"]),[[r.F8,(0,a.SU)(l).toggleWhere]])])])),_:1})])])])),_:1})):(0,t.kq)("",!0)])),_:1})]),(0,t.Wm)(be,{align:"right"},{default:(0,t.w5)((()=>[(0,t.wy)((0,t.Wm)(s,{disable:""==(0,a.SU)(l).title||""==(0,a.SU)(l).sqlQuery,flat:"",label:"Save",icon:"save",color:"primary",onClick:X},null,8,["disable"]),[[Se]]),(0,t.wy)((0,t.Wm)(s,{flat:"",label:"close",color:"red"},null,512),[[Se]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}}};var N=o(151),D=o(5589),H=o(8240),F=o(5869),z=o(8506),I=o(8870),P=o(7011),R=o(3414),j=o(2035),B=o(5096),X=o(2350),Y=o(8107),K=o(6941),G=o(4842),J=o(4554),$=o(8886),ee=o(6778),le=o(8758),oe=o(3017),te=o(8186),ae=o(3884),ie=o(5735),re=o(4522),se=o(9367),de=o(6115),ne=o(677),ue=o(7518),ce=o.n(ue);const me=O,pe=me;ce()(O,"components",{QCard:N.Z,QCardSection:D.Z,QBtn:H.Z,QSeparator:F.Z,QSpinnerIos:z.Z,QTooltip:I.Z,QList:P.Z,QItem:R.Z,QItemSection:j.Z,QAvatar:B.Z,QItemLabel:X.Z,QTable:Y.Z,QInnerLoading:K.Z,QInput:G.Z,QIcon:J.Z,QToggle:$.Z,QDialog:ee.Z,QOptionGroup:le.Z,QSelect:oe.Z,QTr:te.Z,QTd:ae.Z,QCheckbox:ie.Z,QPopupEdit:re.Z,QCardActions:se.Z,QField:de.Z}),ce()(O,"directives",{ClosePopup:ne.Z})}}]);